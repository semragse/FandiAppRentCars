<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <style>
        /* ================================
           THEME VARIABLES - Ocean Breeze Light Theme
           ================================ */
        
        /* Variables CSS pour le th√®me Light (par d√©faut) - Ocean Breeze */
        :root {
            /* Couleurs de base - Ocean Breeze */
            --bg-primary: #F6FBFD;
            --bg-secondary: #E9F5F8;
            --bg-tertiary: #E9F5F8;
            
            /* Couleurs de texte */
            --text-primary: #0A2F35;
            --text-secondary: #6B858C;
            --text-muted: #6B858C;
            
            /* Couleurs d'accentuation */
            --accent-primary: #2A90A8;
            --accent-secondary: #7CC6D7;
            
            /* Header gradient */
            --header-gradient-start: #2A90A8;
            --header-gradient-end: #7CC6D7;
            
            /* Cards et surfaces */
            --card-bg: #E9F5F8;
            --card-border: #D7E9EE;
            --card-shadow: rgba(42, 144, 168, 0.1);
            
            /* Inputs et forms */
            --input-bg: #FFFFFF;
            --input-border: #D7E9EE;
            --input-focus-border: #2A90A8;
            
            /* Boutons */
            --btn-primary-bg: #2A90A8;
            --btn-primary-hover: #1f6d82;
            --btn-danger-bg: #D05B5B;
            --btn-danger-hover: #b34545;
            
            /* Modals */
            --modal-bg: #E9F5F8;
            --modal-overlay: rgba(4, 40, 49, 0.5);
            
            /* Sidebar */
            --sidebar-bg: #E9F5F8;
            
            /* Tables */
            --table-header-bg: #E9F5F8;
            --table-row-hover: #F6FBFD;
        }
        
        /* Variables CSS pour le th√®me Dark */
        body.dark-theme {
            /* Couleurs de base */
            --bg-primary: #042831;
            --bg-secondary: #0A2F35;
            --bg-tertiary: #0f3a42;
            
            /* Couleurs de texte */
            --text-primary: #E9F5F8;
            --text-secondary: #7CC6D7;
            --text-muted: #6B858C;
            
            /* Couleurs d'accentuation */
            --accent-primary: #2A90A8;
            --accent-secondary: #7CC6D7;
            
            /* Header gradient */
            --header-gradient-start: #0A2F35;
            --header-gradient-end: #2A90A8;
            
            /* Cards et surfaces */
            --card-bg: #0A2F35;
            --card-border: #1a4a55;
            --card-shadow: rgba(0, 0, 0, 0.4);
            
            /* Inputs et forms */
            --input-bg: #0f3a42;
            --input-border: #1a4a55;
            --input-focus-border: #2A90A8;
            
            /* Boutons */
            --btn-primary-bg: #2A90A8;
            --btn-primary-hover: #7CC6D7;
            --btn-danger-bg: #D05B5B;
            --btn-danger-hover: #b34545;
            
            /* Modals */
            --modal-bg: #0A2F35;
            --modal-overlay: rgba(4, 40, 49, 0.8);
            
            /* Sidebar */
            --sidebar-bg: #0A2F35;
            
            /* Tables */
            --table-header-bg: #3a3a3a;
            --table-row-hover: #404040;
        }
        
        /* ================================
           RESET ET CONFIGURATION DE BASE
           ================================ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background-color: var(--bg-primary);
            /* Transition smooth pour le changement de th√®me */
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* Header fixe - Navigation professionnelle */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: linear-gradient(135deg, #2A90A8 0%, #7CC6D7 100%);
            color: white;
            padding: 0.75rem 0;
            box-shadow: 0 4px 20px rgba(42, 144, 168, 0.15);
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        /* Navigation centrale */
        .nav-links {
            display: flex;
            align-items: center;
            gap: 2rem;
            flex: 2;
            justify-content: center;
        }

        .nav-links a {
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            font-weight: 600;
            font-size: 0.95rem;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-links a:hover {
            background: rgba(255, 255, 255, 0.15);
            color: white;
            transform: translateY(-1px);
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%) scaleX(0);
            width: 80%;
            height: 2px;
            background: white;
            transition: transform 0.3s ease;
        }

        .nav-links a:hover::after {
            transform: translateX(-50%) scaleX(1);
        }

        /* Menu Hamburger (cach√© sur desktop) */
        .hamburger-menu {
            display: none;
            flex-direction: column;
            cursor: pointer;
            padding: 0.5rem;
            z-index: 1001;
            background: transparent;
            border: none;
            gap: 0;
        }

        .hamburger-menu span {
            width: 25px;
            height: 3px;
            background: white;
            margin: 3px 0;
            transition: all 0.3s ease;
            border-radius: 3px;
            display: block;
        }

        .hamburger-menu.active span:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }

        .hamburger-menu.active span:nth-child(2) {
            opacity: 0;
        }

        .hamburger-menu.active span:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -6px);
        }

        .header-left {
            flex: 1;
            display: flex;
            justify-content: flex-start;
        }

        .admin-link {
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            font-weight: 600;
            font-size: 0.95rem;
            padding: 0.6rem 1.5rem;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 25px;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .admin-link:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.5);
            color: white;
            transform: translateY(-1px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .header-right {
            flex: 1;
            display: flex;
            justify-content: flex-end;
            align-items: center;
            gap: 1rem;
        }

        .contact-link {
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            font-weight: 600;
            font-size: 0.95rem;
            padding: 0.6rem 1.5rem;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 25px;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.1);
        }

        .contact-link:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.5);
            color: white;
            transform: translateY(-1px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        /* ================================
           THEME TOGGLE BUTTON
           ================================ */
        #theme-toggle-btn {
            background: rgba(255, 255, 255, 0.15);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 0;
            position: relative;
        }

        #theme-toggle-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        #theme-toggle-btn:active {
            transform: translateY(0) scale(0.95);
        }

        /* Ic√¥nes SVG pour le th√®me */
        #theme-toggle-btn svg {
            width: 24px;
            height: 24px;
            fill: white;
            position: absolute;
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        #sun-icon {
            display: none; /* Cach√© par d√©faut (light mode) */
        }

        #moon-icon {
            display: block; /* Visible par d√©faut (light mode) */
        }

        /* Logo/Nom du site - MODIFIEZ ICI pour changer le nom */
        .logo {
            font-size: 2.2rem;
            font-weight: 800;
            text-decoration: none;
            color: white;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .logo::before {
            content: "üöó";
            font-size: 1.8rem;
        }

        /* Navigation professionnelle - SUPPRIM√âE POUR HEADER SIMPLIFI√â */
        /*
        .nav {
            display: flex;
            list-style: none;
            gap: 2.5rem;
            align-items: center;
        }

        .nav a {
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            font-weight: 600;
            font-size: 0.95rem;
            padding: 0.6rem 1.2rem;
            border-radius: 25px;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav a:hover {
            background: rgba(255, 255, 255, 0.15);
            color: white;
            transform: translateY(-1px);
        }

        .nav a.active {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }
        */

        /* Section principale */
        .main {
            margin-top: 80px;
            padding: 2rem;
            min-height: calc(100vh - 160px);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            gap: 2rem;
        }

        /* Sidebar de recherche */
        .search-sidebar {
            width: 300px;
            background: var(--sidebar-bg);
            border-radius: 15px;
            box-shadow: 0 5px 20px var(--card-shadow);
            padding: 2rem;
            height: fit-content;
            position: sticky;
            top: 100px;
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
        }

        .search-sidebar h3 {
            color: var(--accent-primary);
            margin-bottom: 1.5rem;
            font-size: 1.3rem;
        }

        .date-group {
            margin-bottom: 1.5rem;
        }

        .date-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
            color: var(--text-primary);
        }

        .date-group input {
            width: 100%;
            padding: 0.8rem;
            background: var(--input-bg);
            color: var(--text-primary);
            border: 2px solid var(--input-border);
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        /* Style harmonis√© pour les <select> (agences) dans la sidebar */
        .date-group select {
            width: 100%;
            padding: 0.8rem 1rem 0.8rem 0.8rem;
            background: var(--input-bg);
            color: var(--text-primary);
            border: 2px solid var(--input-border);
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
            cursor: pointer;
            appearance: none; /* Retirer le style natif */
            background-image: linear-gradient(var(--input-bg), var(--input-bg)), url("data:image/svg+xml,%3Csvg width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%232A90A8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat, no-repeat;
            background-position: right 0.75rem center, right 0.75rem center;
            background-size: 100% 100%, 20px;
        }

        .date-group select:focus {
            outline: none;
            border-color: var(--input-focus-border);
            box-shadow: 0 0 0 3px rgba(42, 144, 168, 0.18);
        }

        /* Petite am√©lioration hover pour feedback */
        .date-group select:hover {
            border-color: var(--input-focus-border);
        }

        .date-group input:focus {
            outline: none;
            border-color: var(--input-focus-border);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .search-btn {
            width: 100%;
            padding: 1rem;
            background: linear-gradient(135deg, #2A90A8 0%, #7CC6D7 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 1rem;
        }

        .search-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(42, 144, 168, 0.4);
        }

        .reset-btn {
            width: 100%;
            padding: 0.8rem;
            background-color: #6c757d;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .reset-btn:hover {
            background-color: #5a6268;
        }

        .seed-btn {
            width: 100%;
            padding: 0.8rem;
            background: linear-gradient(135deg, #E7A84B 0%, #d99535 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            font-weight: 600;
            margin-top: 0.75rem;
            transition: all 0.3s ease;
        }

        .seed-btn:hover {
            box-shadow: 0 5px 15px rgba(231, 168, 75, 0.4);
            transform: translateY(-2px);
        }

        .availability-info {
            background: #E9F5F8;
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1.5rem;
            font-size: 0.9rem;
            border-left: 4px solid #2A90A8;
            transition: all 0.3s ease;
        }

        .availability-info h4 {
            color: #2A90A8;
            margin-bottom: 0.5rem;
            font-size: 1rem;
        }

        .availability-info small {
            display: block;
            margin-top: 0.5rem;
            font-style: italic;
        }

        /* Alerte centrale pour les messages importants */
        .center-alert {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            padding: 2rem;
            text-align: center;
            z-index: 1000;
            min-width: 350px;
            max-width: 500px;
            border: 3px solid #ff6b35;
            display: none;
        }

        .center-alert.error {
            border-color: #ff4757;
        }

        .center-alert.success {
            border-color: #2ed573;
        }

        .center-alert h3 {
            margin-top: 0;
            color: #ff4757;
            font-size: 1.4rem;
            margin-bottom: 1rem;
        }

        .center-alert.success h3 {
            color: #2ed573;
        }

        .center-alert p {
            color: #666;
            font-size: 1.1rem;
            margin-bottom: 1.5rem;
            line-height: 1.5;
        }

        .center-alert .alert-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .center-alert .close-alert {
            background: #ff4757;
            color: white;
            border: none;
            padding: 0.8rem 2rem;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.3s;
        }

        .center-alert .close-alert:hover {
            background: #ff3742;
        }

        .center-alert.success .close-alert {
            background: #2ed573;
        }

        .center-alert.success .close-alert:hover {
            background: #26d467;
        }

        /* Overlay sombre derri√®re l'alerte */
        .alert-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            display: none;
        }

        /* Styles pour les voitures statiques (non r√©servables) */
        .static-car {
            opacity: 0.8;
            position: relative;
        }

        .static-car .car-image {
            background-color: #f8f9fa;
            position: relative;
        }

        .static-car .car-image::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(0,0,0,0.1) 0%, rgba(0,0,0,0.05) 100%);
            pointer-events: none;
        }

        .static-car::after {
            content: "üîí";
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .static-car .car-status {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
            color: white;
        }

        .static-car .reserve-btn {
            background: #bdc3c7 !important;
            cursor: not-allowed;
            color: #7f8c8d;
        }

        .static-car .car-price {
            color: #7f8c8d;
            text-decoration: line-through;
        }

        .static-car .car-name {
            color: #7f8c8d;
        }

        /* Section calcul de prix */
        .price-calculation {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
            border: 1px solid #e9ecef;
        }

        .price-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .price-header h3 {
            margin: 0;
            color: #495057;
            font-size: 1.1rem;
        }

        .calculate-btn {
            background: linear-gradient(135deg, #4CAF78 0%, #3a9260 100%);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .calculate-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(76, 175, 120, 0.3);
        }

        .price-details {
            margin-top: 1rem;
        }

        .price-summary {
            background: white;
            border-radius: 6px;
            padding: 1rem;
            margin-bottom: 1rem;
            border: 1px solid #e9ecef;
        }

        .price-line {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
            border-bottom: 1px solid #f8f9fa;
        }

        .price-line:last-child {
            border-bottom: none;
        }

        .price-line.special {
            color: #fd7e14;
            font-weight: 500;
        }

        .price-line.discount {
            color: #27ae60;
            font-weight: 500;
            background: #f8fff9;
            margin: 0 -1rem;
            padding: 0.5rem 1rem;
            border-radius: 4px;
        }

        .price-line.total {
            border-top: 2px solid #D7E9EE;
            margin-top: 0.5rem;
            padding-top: 1rem;
            font-size: 1.1rem;
            color: #4CAF78;
        }

        .price-calendar {
            background: white;
            border-radius: 6px;
            padding: 1rem;
            border: 1px solid #D7E9EE;
            max-height: 200px;
            overflow-y: auto;
        }

        .calendar-day {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.4rem 0.8rem;
            margin: 0.2rem 0;
            border-radius: 4px;
            font-size: 0.9rem;
        }

        .calendar-day.normal {
            background: #e8f5f8;
            border-left: 3px solid #4CAF78;
        }

        .calendar-day.weekend {
            background: #fef5ec;
            border-left: 3px solid #E7A84B;
        }

        .calendar-day.high-season {
            background: #ffe8e8;
            border-left: 3px solid #D05B5B;
        }

        .calendar-day.holiday {
            background: #d1ecf1;
            border-left: 3px solid #17a2b8;
        }

        .day-label {
            flex: 1;
        }

        .day-price {
            font-weight: 600;
            color: #495057;
        }

        .day-modifier {
            font-size: 0.8rem;
            color: #6c757d;
            margin-left: 0.5rem;
        }

        /* Contenu principal */
        .main-content {
            flex: 1;
            min-height: calc(100vh - 200px);
        }

        .page-title {
            text-align: center;
            margin-bottom: 3rem;
            color: #333;
        }

        .page-title h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            color: #2A90A8;
        }

        .page-title p {
            font-size: 1.1rem;
            color: #6B858C;
        }

        /* Message d'excuse */
        .apologize-message {
            margin: 2rem auto;
            max-width: 600px;
            transition: all 0.4s ease;
        }

        .apologize-card {
            background: linear-gradient(135deg, #ffe8e8 0%, #ffd5d5 100%);
            border: 2px solid #D05B5B;
            border-radius: 15px;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 5px 20px rgba(208, 91, 91, 0.2);
            animation: apologizeSlide 0.6s ease-out;
        }

        .apologize-card h3 {
            color: #D05B5B;
            font-size: 1.4rem;
            margin-bottom: 1rem;
        }

        .apologize-card p {
            color: #0A2F35;
            margin-bottom: 0.8rem;
            font-size: 1rem;
            line-height: 1.5;
        }

        .apologize-card a {
            color: #2A90A8;
            text-decoration: none;
            font-weight: bold;
        }

        .apologize-card a:hover {
            text-decoration: underline;
        }

        @keyframes apologizeSlide {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Grille des voitures */
        .cars-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
            min-height: 600px;
            align-content: start;
        }

        /* Carte de voiture */
        .car-card {
            background: var(--card-bg);
            border-radius: 15px;
            box-shadow: 0 5px 20px var(--card-shadow);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .car-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px var(--card-shadow);
        }

        /* Image de la voiture - REMPLACEZ les URLs des images ici */
        .car-image {
            width: 100%;
            height: 200px;
            background-size: cover;
            background-position: center;
            background-color: var(--bg-tertiary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        /* Images par d√©faut - MODIFIEZ ces URLs pour vos vraies images */
    .car-1 { background-image: url('images/clio5.jpg'); }
    .car-2 { background-image: url('images/audia4.jpg'); }
    .car-3 { background-image: url('images/Mercedes CLA 220.jpg'); }
    .car-4 { background-image: url('images/Dacia Logan.jpg'); }
    .car-5 { background-image: url('images/Peugeot 308.jpg'); }

        .car-content {
            padding: 1.5rem;
        }

        .car-name {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .car-details {
            color: var(--text-secondary);
            margin-bottom: 1rem;
            font-size: 0.95rem;
        }

        .car-price {
            font-size: 1.4rem;
            font-weight: bold;
            color: var(--accent-primary);
            margin-bottom: 1rem;
        }

        .car-status {
            display: inline-block;
            padding: 0.3rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .status-available {
            background-color: #e8f8f0;
            color: #4CAF78;
        }

        .status-reserved {
            background-color: #ffe8e8;
            color: #D05B5B;
        }

        .reserve-btn {
            width: 100%;
            padding: 0.8rem;
            background: linear-gradient(135deg, #2A90A8 0%, #7CC6D7 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .reserve-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(42, 144, 168, 0.4);
        }

        .reserve-btn:disabled {
            background: #6B858C;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Footer professionnel */
        .footer {
            background: linear-gradient(135deg, #0A2F35 0%, #042831 100%);
            color: white;
            padding: 3rem 0 1.5rem 0;
            margin-top: auto;
        }

        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }

        .footer-section {
            text-align: left;
        }

        .footer-section h3 {
            color: #7CC6D7;
            margin-bottom: 1rem;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .footer-section ul {
            list-style: none;
            padding: 0;
        }

        .footer-section ul li {
            margin-bottom: 0.5rem;
        }

        .footer-section a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-section a:hover {
            color: #7CC6D7;
        }

        .footer-section p {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.6;
            margin-bottom: 0.5rem;
        }

        .social-links {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .social-links a {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            color: white;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        .social-links a:hover {
            background: #2A90A8;
            transform: translateY(-2px);
        }

        /* Share buttons */
        .share-links {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .share-btn {
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .share-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.4);
            transform: translateY(-2px);
        }

        .share-btn:active {
            transform: translateY(0);
        }

        .footer-bottom {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 2rem;
            padding-top: 1.5rem;
            text-align: center;
            color: rgba(255, 255, 255, 0.6);
        }

        .footer-bottom a {
            color: #7CC6D7;
            text-decoration: none;
        }

        /* Ic√¥ne WhatsApp flottante */
    .whatsapp-float {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 9999;
            width: 70px;
            height: 70px;
            background: url('images/whatsappincone.jpg') center/cover no-repeat;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            box-shadow: 0 8px 25px rgba(37, 211, 102, 0.4);
            transition: all 0.3s ease;
            animation: pulse 2s infinite;
            border: 3px solid #25d366;
        }

        .whatsapp-float:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 35px rgba(37, 211, 102, 0.6);
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 8px 25px rgba(37, 211, 102, 0.4);
            }
            50% {
                box-shadow: 0 8px 25px rgba(37, 211, 102, 0.7), 0 0 0 10px rgba(37, 211, 102, 0.1);
            }
            100% {
                box-shadow: 0 8px 25px rgba(37, 211, 102, 0.4);
            }
        }

        /* Responsive pour mobile */
        @media (max-width: 768px) {
            .whatsapp-float {
                width: 60px;
                height: 60px;
                bottom: 20px;
                right: 20px;
            }
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            animation: fadeIn 0.3s ease;
            overflow-y: auto;
            padding: 1rem 0;
        }

        .modal-content {
            background-color: var(--modal-bg);
            margin: 2rem auto;
            padding: 2rem;
            border-radius: 15px;
            width: 90%;
            max-width: 650px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideIn 0.3s ease;
            position: relative;
            transition: background-color 0.3s ease;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .modal-title {
            color: var(--text-primary);
            font-size: 1.5rem;
            font-weight: bold;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            color: var(--text-secondary);
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: color 0.3s ease;
        }

        .close-btn:hover {
            color: var(--text-primary);
        }

        /* Formulaire */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
            color: var(--text-primary);
        }

        .form-group input {
            width: 100%;
            padding: 0.8rem;
            background: var(--input-bg);
            color: var(--text-primary);
            border: 2px solid var(--input-border);
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--input-focus-border);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        .btn {
            padding: 0.8rem 2rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #2A90A8 0%, #7CC6D7 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(42, 144, 168, 0.4);
        }

        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background-color: #5a6268;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { 
                opacity: 0;
                transform: translateY(-50%) scale(0.9);
            }
            to { 
                opacity: 1;
                transform: translateY(-50%) scale(1);
            }
        }

        /* Media queries pour responsive design */
        /* ================================
           RESPONSIVE DESIGN - MEDIA QUERIES
           Optimis√© pour Mobile, Tablette et Desktop
           ================================ */

        /* Tablette et petits √©crans (max 1024px) */
        @media (max-width: 1024px) {
            .cars-grid {
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 1.5rem;
            }

            .container {
                padding: 0 1.5rem;
            }
        }

        /* Tablette portrait et mobile landscape (max 768px) */
        @media (max-width: 768px) {
            /* Header responsive */
            .header-content {
                padding: 0 1rem;
                position: relative;
            }

            .logo {
                font-size: 1.5rem;
            }

            .logo::before {
                font-size: 1.2rem;
            }

            /* Afficher le menu hamburger */
            .hamburger-menu {
                display: flex;
                order: 3;
            }

            /* Navigation en mode mobile */
            .nav-links {
                position: fixed;
                top: 60px;
                left: -100%;
                width: 100%;
                height: calc(100vh - 60px);
                background: linear-gradient(135deg, #2A90A8 0%, #7CC6D7 100%);
                flex-direction: column;
                justify-content: flex-start;
                padding: 2rem 1rem;
                gap: 0;
                transition: left 0.3s ease;
                overflow-y: auto;
                z-index: 999;
            }

            .nav-links.active {
                left: 0;
            }

            .nav-links a {
                width: 100%;
                text-align: center;
                padding: 1rem;
                font-size: 1.1rem;
                border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            }

            .nav-links a::after {
                display: none;
            }

            .header-right {
                order: 2;
            }

            .header-left {
                order: 1;
            }

            /* Main content spacing */
            .main {
                padding: 1rem;
                margin-top: 70px;
            }

            .container {
                flex-direction: column;
                gap: 1rem;
                padding: 0 0.5rem;
            }

            /* Sidebar search devient full-width */
            .search-sidebar {
                width: 100%;
                position: static;
                margin-bottom: 1rem;
                padding: 1.5rem;
            }

            /* Page title */
            .page-title h1 {
                font-size: 2rem;
            }

            /* Apologize card */
            .apologize-card {
                padding: 1.5rem;
                margin: 1rem 0;
            }

            .apologize-card h3 {
                font-size: 1.2rem;
            }

            .apologize-card p {
                font-size: 0.9rem;
            }

            /* Grid des voitures - 1 colonne sur tablette */
            .cars-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
                min-height: 400px;
            }

            /* Modal responsive - prend 95% de l'√©cran */
            .modal-content {
                width: 95%;
                max-width: 95%;
                padding: 1.5rem;
                margin: 1rem auto;
                max-height: 95vh;
                overflow-y: auto;
            }

            .modal-title {
                font-size: 1.3rem;
            }

            /* Form actions en colonne */
            .form-actions {
                flex-direction: column;
                gap: 0.8rem;
            }

            .btn {
                width: 100%;
                padding: 0.9rem;
            }

            /* Car card responsive */
            .car-card {
                max-width: 100%;
            }

            .car-image {
                height: 220px;
            }

            /* Price calculation responsive */
            .price-calculation {
                padding: 1.2rem;
            }
        }

        /* Mobile (max 480px) - Optimis√© pour smartphone */
        @media (max-width: 480px) {
            /* Header mobile */
            .header-content {
                flex-wrap: wrap;
                gap: 0.5rem;
            }

            .logo {
                font-size: 1.5rem;
                order: 1;
            }

            .logo::before {
                font-size: 1.3rem;
            }

            .header-right {
                order: 2;
                gap: 0.5rem;
            }

            .nav-links {
                order: 3;
                width: 100%;
                flex-direction: column;
                gap: 0.5rem;
                padding: 0.5rem 0;
                border-top: 1px solid rgba(255, 255, 255, 0.2);
            }

            .nav-links a {
                width: 100%;
                text-align: center;
                padding: 0.6rem;
            }

            .contact-link,
            .admin-link {
                font-size: 0.75rem;
                padding: 0.4rem 0.8rem;
            }

            .header-content {
                padding: 0 0.75rem;
            }

            /* Main content */
            .main {
                padding: 0.75rem;
                margin-top: 65px;
            }

            .container {
                padding: 0;
            }

            /* Search sidebar mobile */
            .search-sidebar {
                padding: 1rem;
                border-radius: 10px;
            }

            .search-sidebar h2 {
                font-size: 1.2rem;
            }

            .filter-group label {
                font-size: 0.9rem;
            }

            .filter-group input,
            .filter-group select {
                padding: 0.6rem;
                font-size: 0.95rem;
            }

            /* Page title mobile */
            .page-title h1 {
                font-size: 1.6rem;
                padding: 0.5rem 0;
            }

            /* Car card mobile */
            .car-content {
                padding: 1rem;
            }

            .car-card h3 {
                font-size: 1.2rem;
            }

            .car-card p {
                font-size: 0.9rem;
            }

            .car-image {
                height: 180px;
            }

            /* Buttons mobile - Plus gros pour le touch */
            .btn {
                padding: 1rem;
                font-size: 1rem;
                min-height: 48px; /* Taille minimale pour touch-friendly */
            }

            .btn-primary {
                font-weight: bold;
            }

            /* Modal mobile - Full screen style */
            .modal-content {
                width: 100%;
                max-width: 100%;
                padding: 1rem;
                margin: 0;
                border-radius: 0;
                max-height: 100vh;
                height: 100%;
            }

            .modal-header {
                margin-bottom: 1.5rem;
                padding-bottom: 1rem;
                border-bottom: 2px solid #e9ecef;
            }

            .modal-title {
                font-size: 1.2rem;
            }

            .close-btn {
                font-size: 1.8rem;
            }

            /* Form mobile */
            .form-group {
                margin-bottom: 1.2rem;
            }

            .form-group label {
                font-size: 0.95rem;
                margin-bottom: 0.4rem;
            }

            .form-group input {
                padding: 0.75rem;
                font-size: 1rem;
                min-height: 48px; /* Touch-friendly */
            }

            /* Price calculation mobile */
            .price-calculation {
                padding: 1rem;
                margin: 0.5rem 0;
                border-radius: 10px;
            }

            .price-header {
                flex-direction: column;
                gap: 1rem;
                align-items: stretch;
            }

            .calculate-btn {
                width: 100%;
                padding: 0.8rem;
                min-height: 48px;
            }

            .price-calendar {
                max-height: 150px;
                overflow-y: auto;
            }

            .calendar-day {
                padding: 0.3rem 0.5rem;
                font-size: 0.8rem;
            }

            .price-line {
                font-size: 0.9rem;
                padding: 0.4rem 0;
            }

            .price-total {
                font-size: 1.3rem;
            }

            /* Apologize card mobile */
            .apologize-card {
                padding: 1.2rem;
                margin: 0.5rem 0;
            }

            .apologize-card h3 {
                font-size: 1.1rem;
            }
        }

        /* Tr√®s petits √©crans (max 360px) - Petits smartphones */
        @media (max-width: 360px) {
            .logo {
                font-size: 1.3rem;
            }

            .contact-link {
                font-size: 0.7rem;
                padding: 0.3rem 0.6rem;
            }

            .page-title h1 {
                font-size: 1.4rem;
            }

            .car-image {
                height: 160px;
            }

            .btn {
                font-size: 0.9rem;
            }
        }

        /* Landscape mobile (orientation paysage) */
        @media (max-height: 500px) and (orientation: landscape) {
            .modal-content {
                max-height: 95vh;
                overflow-y: scroll;
            }

            .car-image {
                height: 150px;
            }

            .main {
                margin-top: 60px;
            }
        }

        /* Print styles - Pour impression */
        @media print {
            .header,
            .search-sidebar,
            .btn,
            .modal {
                display: none !important;
            }

            .cars-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .car-card {
                break-inside: avoid;
            }
        }

        /* √âtats de chargement */
        .loading {
            opacity: 0.7;
            pointer-events: none;
        }

        /* Success message */
        .success-message {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            display: none;
        }
    </style>
</head>
<body>
    <script>
        // Helpers date locaux centralis√©s (√©vite erreurs UTC toISOString)
        function todayLocal() {
            const d = new Date();
            const y = d.getFullYear();
            const m = String(d.getMonth() + 1).padStart(2, '0');
            const day = String(d.getDate()).padStart(2, '0');
            return `${y}-${m}-${day}`;
        }
        function dateToLocalYMD(d) {
            const y = d.getFullYear();
            const m = String(d.getMonth() + 1).padStart(2, '0');
            const day = String(d.getDate()).padStart(2, '0');
            return `${y}-${m}-${day}`;
        }
    </script>
    <!-- Header avec logo centr√© et contact √† droite -->
    <header class="header">
        <div class="header-content">
            <!-- Logo √† gauche -->
            <a href="#" class="logo">FANDIAUTO</a>
            
            <!-- Menu Hamburger (mobile) -->
            <button class="hamburger-menu" id="hamburgerMenu" aria-label="Toggle menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
            
            <!-- Navigation centrale -->
            <nav class="nav-links" id="navLinks">
                <a href="pages/conditions.html">Nos Conditions</a>
                <a href="pages/faq.html">FAQ</a>
                <a href="pages/ma-reservation.html">Ma R√©servation</a>
                <a href="pages/contact.html">Contact</a>
            </nav>
            
            <!-- Actions √† droite + Theme Toggle -->
            <div class="header-right">
                <!-- Bouton de changement de th√®me Dark/Light -->
                <button id="theme-toggle-btn" aria-label="Toggle dark/light theme">
                    <!-- Ic√¥ne Soleil (visible en dark mode pour passer en light) -->
                    <svg id="sun-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M12 17.5C9.5 17.5 7.5 15.5 7.5 13S9.5 8.5 12 8.5 16.5 10.5 16.5 13 14.5 17.5 12 17.5M12 7C8.7 7 6 9.7 6 13S8.7 19 12 19 18 16.3 18 13 15.3 7 12 7M12 2L14.4 5.6 18.7 4.4 18.2 8.8 22 11L18.2 13.2 18.7 17.6 14.4 16.4 12 20 9.6 16.4 5.3 17.6 5.8 13.2 2 11 5.8 8.8 5.3 4.4 9.6 5.6 12 2Z"/>
                    </svg>
                    <!-- Ic√¥ne Lune (visible en light mode pour passer en dark) -->
                    <svg id="moon-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M17.75,4.09L15.22,6.03L16.13,9.09L13.5,7.28L10.87,9.09L11.78,6.03L9.25,4.09L12.44,4L13.5,1L14.56,4L17.75,4.09M21.25,11L19.61,12.25L20.2,14.23L18.5,13.06L16.8,14.23L17.39,12.25L15.75,11L17.81,10.95L18.5,9L19.19,10.95L21.25,11M18.97,15.95C19.8,15.87 20.69,17.05 20.16,17.8C19.84,18.25 19.5,18.67 19.08,19.07C15.17,23 8.84,23 4.94,19.07C1.03,15.17 1.03,8.83 4.94,4.93C5.34,4.53 5.76,4.17 6.21,3.85C6.96,3.32 8.14,4.21 8.06,5.04C7.79,7.9 8.75,10.87 10.95,13.06C13.14,15.26 16.1,16.22 18.97,15.95M17.33,17.97C14.5,17.81 11.7,16.64 9.53,14.5C7.36,12.31 6.2,9.5 6.04,6.68C3.23,9.82 3.34,14.64 6.35,17.66C9.37,20.67 14.19,20.78 17.33,17.97Z"/>
                    </svg>
                </button>
            </div>
        </div>
    </header>

    <!-- Simple Hamburger Menu Script -->
    <script>
        (function() {
            function toggleMenu() {
                const hamburger = document.getElementById('hamburgerMenu');
                const nav = document.getElementById('navLinks');
                
                if (hamburger && nav) {
                    hamburger.classList.toggle('active');
                    nav.classList.toggle('active');
                    
                    // Prevent body scroll when menu is open
                    document.body.style.overflow = nav.classList.contains('active') ? 'hidden' : '';
                }
            }
            
            // Wait for DOM to be ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', init);
            } else {
                init();
            }
            
            function init() {
                const hamburger = document.getElementById('hamburgerMenu');
                const nav = document.getElementById('navLinks');
                
                if (hamburger) {
                    hamburger.onclick = function(e) {
                        e.preventDefault();
                        toggleMenu();
                    };
                }
                
                // Close menu when clicking on nav links
                if (nav) {
                    const links = nav.getElementsByTagName('a');
                    for (let i = 0; i < links.length; i++) {
                        links[i].onclick = function() {
                            toggleMenu();
                        };
                    }
                }
            }
        })();
    </script>

    <!-- Section principale -->
    <main class="main">
        <div class="container">
            <!-- Sidebar de recherche -->
            <aside class="search-sidebar">
                <h3>R√©server en ligne</h3>
                <!-- Agences : mettez √† jour la liste des options ci-dessous si vous ajoutez de nouveaux points de service.
                     Cette section alimente la s√©lection d'agence pour la recherche rapide. -->
                <div class="date-group">
                    <label for="searchDepartureAgency">Agence de D√©part :</label>
                    <select id="searchDepartureAgency" name="searchDepartureAgency" required>
                        <option value="" disabled selected>Choisissez une agence</option>
                        <!-- LISTE AGENCES (MAINTENANCE UNIQUE) : Modifier ici pour mettre √† jour partout si vous synchronisez ensuite avec la modal. -->
                        <option value="A√©roport Tlemcen">A√©roport Tlemcen</option>
                        <option value="A√©roport Oran">A√©roport Oran</option>
                        <option value="Agence Tlemcen">Agence Tlemcen</option>
                    </select>
                </div>
                <div class="date-group">
                    <label for="searchReturnAgency">Agence de Retour :</label>
                    <select id="searchReturnAgency" name="searchReturnAgency" required>
                        <option value="" disabled selected>Choisissez une agence</option>
                        <option value="A√©roport Tlemcen">A√©roport Tlemcen</option>
                        <option value="A√©roport Oran">A√©roport Oran</option>
                        <option value="Agence Tlemcen">Agence Tlemcen</option>
                    </select>
                </div>
                
                <div class="date-group">
                    <label for="searchStartDate">Date de d√©but :</label>
                    <input type="date" id="searchStartDate" name="searchStartDate" min="">
                </div>

                <div class="date-group">
                    <label for="searchEndDate">Date de fin :</label>
                    <input type="date" id="searchEndDate" name="searchEndDate" min="">
                </div>

                <button class="search-btn" id="searchAvailability">
                    üîç Rechercher la disponibilit√©
                </button>

                <button class="reset-btn" id="resetSearch">
                    üîÑ R√©initialiser
                </button>

                <!-- Seed button supprim√© -->

                <div class="availability-info" id="availabilityInfo" style="display: none;">
                    <h4>R√©sultats :</h4>
                    <p id="availabilityText">S√©lectionnez des dates pour voir la disponibilit√©</p>
                </div>
            </aside>

            <!-- Contenu principal -->
            <div class="main-content">
                <!-- Titre de la page -->
                <section class="page-title">
                    <h1>Location de voiture Fandi</h1>
                    
                    <!-- Message d'excuse pour indisponibilit√© -->
                    <div class="apologize-message" id="apologizeMessage" style="display: none;">
                        <div class="apologize-card">
                            <h3>üöó Nous nous excusons</h3>
                            <p>Toutes nos voitures sont actuellement <strong>r√©serv√©es pour aujourd'hui</strong> (28/10/2025).</p>
                            <p>üìÖ Veuillez utiliser notre <strong>recherche par dates</strong> pour voir la disponibilit√© √† partir de <strong>demain</strong>.</p>
                            <p>üìû Pour toute urgence, contactez-nous au <a href="tel:+213771391480"><strong>+213 771 39 14 80</strong></a></p>
                        </div>
                    </div>
                </section>

                <!-- Grille des voitures - dynamically populated from backend + static cars -->
            <section class="cars-grid">
                <!-- Car cards will be loaded dynamically from the backend API -->
                
                <!-- Voitures suppl√©mentaires (non disponibles √† la r√©servation - statiques) -->
                
                <!-- Voiture 6 - BMW X3 -->
                <article class="car-card static-car" data-car-name="BMW X3">
                    <div class="car-image" style="background-image: url('images/BMW X3.jpg'); background-size: cover; background-position: center;">
                    </div>
                    <div class="car-content">
                        <h3 class="car-name">BMW X3</h3>
                        <div class="car-price">95‚Ç¨/jour</div>
                        <span class="car-status status-reserved">Non disponible</span>
                        <button class="reserve-btn" disabled style="opacity: 0.5;">Bient√¥t disponible</button>
                    </div>
                </article>

                <!-- Voiture 7 - Volkswagen Golf -->
                <article class="car-card static-car" data-car-name="Volkswagen Golf">
                    <div class="car-image" style="background-image: url('images/Volkswagen Golf.jpg'); background-size: cover; background-position: center;">
                    </div>
                    <div class="car-content">
                        <h3 class="car-name">Volkswagen Golf</h3>
                        <div class="car-price">55‚Ç¨/jour</div>
                        <span class="car-status status-reserved">Non disponible</span>
                        <button class="reserve-btn" disabled style="opacity: 0.5;">Bient√¥t disponible</button>
                    </div>
                </article>

                <!-- Voiture 8 - Toyota Corolla -->
                <article class="car-card static-car" data-car-name="Toyota Corolla">
                    <div class="car-image" style="background-image: url('images/Toyota Corolla.jpg'); background-size: cover; background-position: center;">
                    </div>
                    <div class="car-content">
                        <h3 class="car-name">Toyota Corolla</h3>
                        <div class="car-price">60‚Ç¨/jour</div>
                        <span class="car-status status-reserved">Non disponible</span>
                        <button class="reserve-btn" disabled style="opacity: 0.5;">Bient√¥t disponible</button>
                    </div>
                </article>

                <!-- Voiture 9 - Hyundai i20 -->
                <article class="car-card static-car" data-car-name="Hyundai i20">
                    <div class="car-image" style="background-image: url('images/Hyundai i20.jpg'); background-size: cover; background-position: center;">
                    </div>
                    <div class="car-content">
                        <h3 class="car-name">Hyundai i20</h3>
                        <div class="car-price">40‚Ç¨/jour</div>
                        <span class="car-status status-reserved">Non disponible</span>
                        <button class="reserve-btn" disabled style="opacity: 0.5;">Bient√¥t disponible</button>
                    </div>
                </article>

                <!-- Voiture 10 - Ford Focus -->
                <article class="car-card static-car" data-car-name="Ford Focus">
                    <div class="car-image" style="background-image: url('images/Ford Focus.jpg'); background-size: cover; background-position: center;">
                    </div>
                    <div class="car-content">
                        <h3 class="car-name">Ford Focus</h3>
                        <div class="car-price">50‚Ç¨/jour</div>
                        <span class="car-status status-reserved">Non disponible</span>
                        <button class="reserve-btn" disabled style="opacity: 0.5;">Bient√¥t disponible</button>
                    </div>
                </article>

                <!-- Voiture 11 - Seat Ibiza -->
                <article class="car-card static-car" data-car-name="Seat Ibiza">
                    <div class="car-image" style="background-image: url('images/Seat Ibiza.jpg'); background-size: cover; background-position: center;">
                    </div>
                    <div class="car-content">
                        <h3 class="car-name">Seat Ibiza</h3>
                        <div class="car-price">42‚Ç¨/jour</div>
                        <span class="car-status status-reserved">Non disponible</span>
                        <button class="reserve-btn" disabled style="opacity: 0.5;">Bient√¥t disponible</button>
                    </div>
                </article>
            </section>
            
            <!-- Espacement pour garantir la hauteur -->
            <div style="height: 200px;"></div>
            </div> <!-- Fin main-content -->
        </div>
    </main>

    <!-- Footer professionnel -->
    <footer class="footer">
        <div class="footer-content">
            <!-- Navigation -->
            <div class="footer-section">
                <h3>Navigation</h3>
                <ul>
                    <li><a href="index.html">üè† Accueil</a></li>
                    <li><a href="pages/conditions.html">üìã Nos Conditions</a></li>
                    <li><a href="pages/faq.html">‚ùì FAQ</a></li>
                    <li><a href="pages/ma-reservation.html">üîç Ma R√©servation</a></li>
                    <li><a href="pages/contact.html">üìû Contact</a></li>
                </ul>
            </div>

            <!-- Contact -->
            <div class="footer-section">
                <h3>Contact</h3>
                <p>üìç <span data-contact="address">47 Riat Makhoukh, mansourah Tlemcen 13000 Alg√©rie</span></p>
                <p>üìû <a href="tel:+213771391480" data-contact="phone">+213 771 39 14 80</a></p>
                <p>‚úâÔ∏è <a href="mailto:contact@fandiauto.dz" data-contact="email">contact@fandiauto.dz</a></p>
                <p>üïí Lun-Dim: 8h00 - 20h00</p>
            </div>

            <!-- R√©seaux Sociaux -->
            
            
            <!-- FANDIAUTO -->
            <div class="footer-section">
                <h3 data-contact="company">FANDIAUTO</h3>
                
                <p style="margin-top: 1rem;"><strong>Pourquoi nous choisir ?</strong></p>
                <ul>
                    <li>‚úÖ V√©hicules r√©cents et bien entretenus</li>
                    <li>‚úÖ Tarifs comp√©titifs et transparents</li>
                    <li>‚úÖ Service client disponible 7j/7</li>
                    <li>‚úÖ R√©servation en ligne simple et rapide</li>
                </ul>
            </div>
        </div>
                -->
        <div class="footer-bottom">
            <p>&copy; 2025 FANDIAUTO - Tous droits r√©serv√©s</p>
        </div>
    </footer>

    <!-- Modal de r√©servation -->
    <div id="reservationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">R√©server une voiture</h2>
                <button class="close-btn" id="closeModal">&times;</button>
            </div>

            <!-- Message de succ√®s -->
            <div id="successMessage" class="success-message">
                Votre demande de r√©servation a √©t√© envoy√©e avec succ√®s !
            </div>

            <!-- Formulaire de r√©servation -->
            <form id="reservationForm">
                <div class="form-group">
                    <label for="carName">V√©hicule s√©lectionn√© :</label>
                    <input type="text" id="carName" name="carName" readonly>
                </div>

                <div class="form-group">
                    <label for="customerName">Nom complet :</label>
                    <input type="text" id="customerName" name="customerName" required placeholder="Votre nom complet">
                </div>

                <div class="form-group">
                    <label for="customerEmail">Adresse e-mail :</label>
                    <input type="email" id="customerEmail" name="customerEmail" required placeholder="votre.email@exemple.com">
                </div>

                <div class="form-group">
                    <label for="departureAgency">Agence de D√©part :</label>
                    <select id="departureAgency" name="departureAgency" required>
                        <option value="" disabled selected>Choisissez une agence de d√©part</option>
                        <!-- LISTE AGENCES (SYNC AVEC SIDEBAR) : Si vous modifiez, mettez √† jour aussi searchDepartureAgency -->
                        <option value="A√©roport Tlemcen">A√©roport Tlemcen</option>
                        <option value="A√©roport Oran">A√©roport Oran</option>
                        <option value="Agence Tlemcen">Agence Tlemcen</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="returnAgency">Agence de Retour :</label>
                    <select id="returnAgency" name="returnAgency" required>
                        <option value="" disabled selected>Choisissez une agence de retour</option>
                        <!-- LISTE AGENCES (SYNC AVEC SIDEBAR) -->
                        <option value="A√©roport Tlemcen">A√©roport Tlemcen</option>
                        <option value="A√©roport Oran">A√©roport Oran</option>
                        <option value="Agence Tlemcen">Agence Tlemcen</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="startDate">Date de d√©but :</label>
                    <input type="date" id="startDate" name="startDate" required>
                </div>

                <div class="form-group">
                    <label for="endDate">Date de fin :</label>
                    <input type="date" id="endDate" name="endDate" required>
                </div>

                <!-- Section calcul de prix -->
                <div class="price-calculation" id="priceCalculation" style="display: none;">
                    <div class="price-header">
                        <h3>üìä Calcul du prix</h3>
                        <button type="button" class="calculate-btn" id="calculatePrice">
                            üí∞ Calculer le prix
                        </button>
                    </div>
                    
                    <div class="price-details" id="priceDetails" style="display: none;">
                        <div class="price-summary">
                            <div class="price-line">
                                <span>Nombre de jours :</span>
                                <span id="totalDays">-</span>
                            </div>
                            <div class="price-line">
                                <span>Prix de base :</span>
                                <span id="basePrice">-</span>
                            </div>
                            <div class="price-line special" id="weekendLine" style="display: none;">
                                <span>Jours week-end (+30%) :</span>
                                <span id="weekendDays">-</span>
                            </div>
                            <div class="price-line special" id="highSeasonLine" style="display: none;">
                                <span>Haute saison (+30%) :</span>
                                <span id="highSeasonDays">-</span>
                            </div>
                            <div class="price-line special" id="holidayLine" style="display: none;">
                                <span>Vacances (+30%) :</span>
                                <span id="holidayDays">-</span>
                            </div>
                            <div class="price-line">
                                <span>Prix avec majorations :</span>
                                <span id="totalPrice">-</span>
                            </div>
                            <div class="price-line discount" id="discountLine" style="display: none;">
                                <span id="discountDescription">Remise d√©gressive :</span>
                                <span id="discountAmount" style="color: #27ae60;">-</span>
                            </div>
                            <div class="price-line total">
                                <span><strong>Prix final :</strong></span>
                                <span id="finalPrice"><strong>-</strong></span>
                            </div>
                        </div>
                        
                        <div class="price-calendar" id="priceCalendar">
                            <!-- Calendrier des prix sera g√©n√©r√© ici -->
                        </div>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelBtn">Annuler</button>
                    <button type="submit" class="btn btn-primary">Confirmer la r√©servation</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Popup rapide de r√©servation (simplifi√© pour paiement) -->
    <div id="quickReservationModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.45); z-index:2500; overflow-y:auto;">
        <div style="background:#ffffff; width:94%; max-width:400px; margin:6% auto 6% auto; padding:1.4rem 1.6rem 1.6rem; border-radius:18px; box-shadow:0 20px 50px rgba(0,0,0,0.25); position:relative; font-family:Arial,sans-serif; max-height:90vh; overflow-y:auto;">
            <button id="quickCloseBtn" style="position:absolute; top:10px; right:12px; background:none; border:none; font-size:1.5rem; cursor:pointer; color:#666; z-index:10;">&times;</button>
            <h3 style="margin:0 0 1rem 0; color:#2A90A8; font-size:1.25rem; font-weight:700;">‚ö° R√©servation</h3>
            <div style="display:flex; flex-direction:column; gap:.95rem;">
                <div>
                    <label style="font-weight:600; font-size:.75rem; letter-spacing:.5px; color:#555; text-transform:uppercase;">V√©hicule</label>
                    <div id="quickCarName" style="margin-top:.35rem; background:#f8f9fa; border:2px solid #e9ecef; border-radius:10px; padding:.65rem .75rem; font-weight:600; font-size:.9rem; color:#333;">-</div>
                </div>
                <div>
                    <label style="font-weight:600; font-size:.75rem; letter-spacing:.5px; color:#555; text-transform:uppercase;">Agence de D√©part</label>
                    <select id="quickDepartureAgency" style="margin-top:.35rem; width:100%; padding:.55rem .6rem; border:2px solid #e9ecef; border-radius:10px; font-size:.85rem; background:#fff; cursor:pointer;" required>
                        <option value="" disabled selected>Choisir une agence</option>
                        <option value="A√©roport Tlemcen">A√©roport Tlemcen</option>
                        <option value="A√©roport Oran">A√©roport Oran</option>
                        <option value="Agence Tlemcen">Agence Tlemcen</option>
                    </select>
                </div>
                <div>
                    <label style="font-weight:600; font-size:.75rem; letter-spacing:.5px; color:#555; text-transform:uppercase;">Agence de Retour</label>
                    <select id="quickReturnAgency" style="margin-top:.35rem; width:100%; padding:.55rem .6rem; border:2px solid #e9ecef; border-radius:10px; font-size:.85rem; background:#fff; cursor:pointer;" required>
                        <option value="" disabled selected>Choisir une agence</option>
                        <option value="A√©roport Tlemcen">A√©roport Tlemcen</option>
                        <option value="A√©roport Oran">A√©roport Oran</option>
                        <option value="Agence Tlemcen">Agence Tlemcen</option>
                    </select>
                </div>
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:.85rem;">
                    <div>
                        <label style="font-weight:600; font-size:.75rem; letter-spacing:.5px; color:#555; text-transform:uppercase;">D√©but</label>
                        <input type="date" id="quickStart" style="margin-top:.35rem; width:100%; padding:.55rem .6rem; border:2px solid #e9ecef; border-radius:10px; font-size:.85rem;" />
                    </div>
                    <div>
                        <label style="font-weight:600; font-size:.75rem; letter-spacing:.5px; color:#555; text-transform:uppercase;">Fin</label>
                        <input type="date" id="quickEnd" style="margin-top:.35rem; width:100%; padding:.55rem .6rem; border:2px solid #e9ecef; border-radius:10px; font-size:.85rem;" />
                    </div>
                </div>
                <div id="quickPriceBox" style="background:#f8f9fa; border:2px solid #e9ecef; border-radius:14px; padding:.85rem .9rem; display:none;">
                    <!-- R√©sum√© rapide -->
                    <div style="display:flex; justify-content:space-between; font-size:.85rem; margin-bottom:.4rem;">
                        <span style="color:#555;">Tarif journalier:</span>
                        <strong id="quickDailyRate">-</strong>
                    </div>
                    
                    <!-- Sous-total (avant r√©duction) -->
                    <div id="quickSubtotal" style="display:flex; justify-content:space-between; font-size:.85rem; margin-bottom:.4rem;">
                        <span style="color:#555;">Sous-total:</span>
                        <strong id="quickSubtotalPrice" style="color:#333;">-</strong>
                    </div>
                    
                    <!-- R√©duction longue dur√©e (si applicable) -->
                    <div id="quickDiscountRow" style="display:none; background:#d4edda; border:2px solid #28a745; border-radius:8px; padding:.6rem; margin-bottom:.6rem;">
                        <div style="display:flex; justify-content:space-between; align-items:center;">
                            <div>
                                <div style="font-size:.75rem; color:#155724; font-weight:600; text-transform:uppercase;">üéâ R√©duction longue dur√©e</div>
                                <div id="quickDiscountLabel" style="font-size:.7rem; color:#155724; margin-top:.15rem;">-</div>
                            </div>
                            <strong id="quickDiscountAmount" style="color:#28a745; font-size:1rem;">-</strong>
                        </div>
                    </div>
                    
                    <!-- Prix final -->
                    <div style="display:flex; justify-content:space-between; font-size:.95rem; margin-bottom:.6rem; padding-top:.4rem; border-top:2px solid #dee2e6;">
                        <span style="color:#333; font-weight:600;">Prix final:</span>
                        <strong id="quickTotalPrice" style="color:#28a745; font-size:1.15rem;">-</strong>
                    </div>
                    
                    <!-- D√©tail jour par jour (pour Clio 5) -->
                    <div id="quickBreakdown" style="display:none; margin-top:.8rem; padding-top:.8rem; border-top:2px solid #e9ecef;">
                        <div style="font-weight:600; font-size:.8rem; color:#2A90A8; margin-bottom:.5rem; text-transform:uppercase; letter-spacing:.5px;">üìä D√©tail par jour</div>
                        <div id="quickBreakdownDays" style="max-height:150px; overflow-y:auto;">
                            <!-- Rempli dynamiquement -->
                        </div>
                    </div>
                </div>
                <div id="quickError" style="display:none; background:#f8d7da; color:#721c24; padding:.55rem .7rem; border-radius:8px; font-size:.75rem; font-weight:600;"></div>
                <div style="display:flex; gap:.75rem; margin-top:.2rem;">
                    <button type="button" id="quickCancelBtn" style="flex:1; padding:.65rem .9rem; background:#6c757d; color:#fff; border:none; border-radius:10px; font-weight:600; font-size:.85rem; cursor:pointer;">Annuler</button>
                    <button type="button" id="quickPayBtn" style="flex:1; padding:.65rem .9rem; background:linear-gradient(135deg,#2A90A8 0%,#7CC6D7 100%); color:#fff; border:none; border-radius:10px; font-weight:600; font-size:.85rem; cursor:pointer;">Aller au paiement ‚Üí</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Variables globales
        const modal = document.getElementById('reservationModal');
        const form = document.getElementById('reservationForm');
        const closeBtn = document.getElementById('closeModal');
        const cancelBtn = document.getElementById('cancelBtn');
        const successMessage = document.getElementById('successMessage');
        const reserveButtons = document.querySelectorAll('.reserve-btn');
        
        // Variables pour la recherche active
        let currentSearchDates = {
            startDate: null,
            endDate: null,
            departureAgency: null,
            returnAgency: null
        };

        // Base de donn√©es des voitures avec r√©servations (mise √† jour: toutes les dates futures)
        // Base de donn√©es des voitures (sera charg√©e dynamiquement depuis l'API)
        // Rendue globale pour √™tre accessible par carPricing.js
        window.carsDatabase = {};
        let carsDatabase = window.carsDatabase; // Alias local pour faciliter l'acc√®s

        /**
         * Charge les voitures depuis l'API backend
         * Synchronise automatiquement avec les voitures ajout√©es via le panneau admin
         */
        async function loadCarsFromAPI() {
            try {
                console.log('üîÑ Chargement des voitures depuis l\'API...');
                const response = await fetch('http://localhost:3001/cars');
                
                if (!response.ok) {
                    throw new Error(`Erreur API: ${response.status}`);
                }
                
                const cars = await response.json();
                console.log(`‚úÖ ${cars.length} voitures charg√©es depuis l'API`);
                console.log('üöó First car carType:', cars[0]?.carType);
                
                // Charger aussi les r√©servations
                const reservationsResponse = await fetch('http://localhost:3001/reservations');
                const allReservations = reservationsResponse.ok ? await reservationsResponse.json() : [];
                
                // Convertir le format API vers le format carsDatabase
                // Vider l'objet existant au lieu de cr√©er un nouveau (pour garder la r√©f√©rence window.carsDatabase)
                Object.keys(carsDatabase).forEach(key => delete carsDatabase[key]);
                
                cars.forEach(car => {
                    // Filtrer les r√©servations pour cette voiture (seulement les accept√©es)
                    const carReservations = allReservations
                        .filter(res => res.carId === car.id && res.status === 'accepted')
                        .map(res => ({
                            id: res.id,
                            startDate: res.startDate,
                            endDate: res.endDate
                        }));
                    
                    carsDatabase[car.id] = {
                        id: car.id,
                        name: car.name,
                        price: car.price,
                        image: car.image || `images/${car.name.toLowerCase().replace(/ /g, '')}.jpg`,
                        carType: car.carType,
                        seats: car.seats,
                        fuelType: car.fuelType,
                        transmission: car.transmission,
                        airConditioning: car.airConditioning,
                        doors: car.doors,
                        locationAgency: car.locationAgency,
                        reservations: carReservations
                    };
                });
                
                console.log('üìä Base de donn√©es locale mise √† jour:', carsDatabase);
                
                // Mettre √† jour l'affichage des voitures
                updateCarsDisplay();
                
                return carsDatabase;
            } catch (error) {
                console.error('‚ùå Erreur lors du chargement des voitures:', error);
                
                // Fallback: utiliser des donn√©es par d√©faut si l'API n'est pas disponible
                console.warn('‚ö†Ô∏è Utilisation des donn√©es par d√©faut (API non disponible)');
                
                // Vider l'objet existant
                Object.keys(carsDatabase).forEach(key => delete carsDatabase[key]);
                
                // Ajouter les voitures par d√©faut
                Object.assign(carsDatabase, {
                    car1: {
                        id: 'car1',
                        name: 'Clio 5',
                        price: 35,
                        image: 'images/clio5.jpg',
                        carType: 'Citadine',
                        reservations: []
                    },
                    car2: {
                        id: 'car2',
                        name: 'Audi A4',
                        price: 85,
                        image: 'images/audia4.jpg',
                        carType: 'Berline',
                        reservations: []
                    },
                    car3: {
                        id: 'car3',
                        name: 'Mercedes CLA 220',
                        price: 120,
                        image: 'images/Mercedes CLA 220.jpg',
                        carType: 'Luxe',
                        reservations: []
                    },
                    car4: {
                        id: 'car4',
                        name: 'Dacia Logan',
                        price: 45,
                        image: 'images/Dacia Logan.jpg',
                        reservations: []
                    },
                    car5: {
                        id: 'car5',
                        name: 'Peugeot 308',
                        price: 65,
                        image: 'images/Peugeot 308.jpg',
                        reservations: []
                    }
                });
                updateCarsDisplay();
                return carsDatabase;
            }
        }

        /**
         * Met √† jour l'affichage des cartes de voitures dans le DOM
         * Pr√©serve les voitures statiques (non synchronis√©es avec le backend)
         */
        function updateCarsDisplay() {
            const carsGrid = document.querySelector('.cars-grid');
            if (!carsGrid) {
                console.warn('‚ö†Ô∏è √âl√©ment .cars-grid non trouv√©');
                return;
            }
            
            // Sauvegarder les voitures statiques (celles qui ne sont pas dans le backend)
            const staticCars = Array.from(carsGrid.querySelectorAll('.static-car'));
            
            // Supprimer uniquement les voitures dynamiques (pas les static-car)
            const dynamicCars = carsGrid.querySelectorAll('.car-card:not(.static-car)');
            dynamicCars.forEach(card => card.remove());
            
            // Cr√©er un fragment pour les nouvelles voitures dynamiques
            const fragment = document.createDocumentFragment();
            
            // G√©n√©rer les cartes pour chaque voiture du backend
            for (const carId in carsDatabase) {
                const car = carsDatabase[carId];
                const carCard = createCarCard(car);
                fragment.appendChild(carCard);
            }
            
            // Ins√©rer les voitures dynamiques AVANT les voitures statiques
            if (staticCars.length > 0) {
                carsGrid.insertBefore(fragment, staticCars[0]);
            } else {
                carsGrid.appendChild(fragment);
            }
            
            console.log(`‚úÖ ${Object.keys(carsDatabase).length} voitures dynamiques + ${staticCars.length} voitures statiques affich√©es`);
            
            // Appliquer le statut des r√©servations (uniquement sur les voitures dynamiques)
            applyTodayReservationsStatus();
        }

        /**
         * Cr√©e une carte de voiture (√©l√©ment DOM)
         */
        function createCarCard(car) {
            console.log('üîß Creating card for:', car.name, 'Type:', car.carType);
            const card = document.createElement('article');
            card.className = 'car-card';
            card.setAttribute('data-car-id', car.id);
            
            // Utiliser l'image de la base de donn√©es (d√©j√† stock√©e lors de l'ajout dans l'admin)
            const imagePath = car.image || `images/${car.name}.jpg`;
            
            // Cr√©er l'√©l√©ment image avec gestion du placeholder
            const carImageDiv = document.createElement('div');
            carImageDiv.className = 'car-image';
            carImageDiv.style.cssText = `background-image: url('${imagePath}'); background-size: cover; background-position: center; background-color: #f0f0f0;`;
            
            // Tester si l'image existe
            const img = new Image();
            img.onload = function() {
                // L'image existe, on l'affiche normalement
                carImageDiv.style.backgroundImage = `url('${imagePath}')`;
            };
            img.onerror = function() {
                // L'image n'existe pas, afficher un placeholder
                carImageDiv.innerHTML = `
                    <div style="display: flex; align-items: center; justify-content: center; height: 100%; color: #666; font-size: 1.2rem; text-align: center; padding: 2rem; background: linear-gradient(135deg, #2A90A8 0%, #7CC6D7 100%);">
                        <span style="color: white; font-weight: bold;">ÔøΩ ${car.name}</span>
                    </div>
                `;
            };
            img.src = imagePath;
            
            // Contenu de la carte
            const carContent = document.createElement('div');
            carContent.className = 'car-content';
            
            // Cr√©er le badge de type de voiture
            const carTypeBadge = car.carType ? `
                <div style="display: inline-block; padding: 0.3rem 0.8rem; background: linear-gradient(135deg, #2A90A8 0%, #1a6578 100%); color: white; border-radius: 20px; font-size: 0.85rem; font-weight: 600; margin-bottom: 0.5rem; box-shadow: 0 2px 4px rgba(42, 144, 168, 0.3);">
                    üöó ${car.carType}
                </div>
            ` : '';
            
            // Cr√©er les caract√©ristiques de la voiture
            const features = `
                <div style="display: flex; flex-direction: column; gap: 0.4rem; margin: 1rem 0; font-size: 0.9rem; color: #555;">
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <span>üë•</span> <span>${car.seats || 5} places</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <span>‚õΩ</span> <span>${car.fuelType || 'Essence SP'}</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <span>‚öôÔ∏è</span> <span>${car.transmission || 'Automatique'}</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <span>‚ùÑÔ∏è</span> <span>${car.airConditioning !== false ? 'Climatisation' : 'Sans climatisation'}</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <span>üö™</span> <span>${car.doors || 5} portes</span>
                    </div>
                </div>
            `;
            
            carContent.innerHTML = `
                <h3 class="car-name">${car.name}</h3>
                ${carTypeBadge}
                ${features}
                <div class="car-price">${car.price}‚Ç¨<span style="font-size: 0.9rem; font-weight: normal;">/jour</span></div>
                <span class="car-status status-available">Disponible</span>
                <button class="reserve-btn" data-car="${car.name}" data-price="${car.price}">
                    R√©server cette voiture
                </button>
            `;
            
            card.appendChild(carImageDiv);
            card.appendChild(carContent);
            
            return card;
        }

        // Fonction pour d√©finir dynamiquement les min sur les inputs date
        function setDynamicMinDates() {
            const today = todayLocal();
            const dateInputs = ['searchStartDate','searchEndDate','startDate','endDate']
                .map(id => document.getElementById(id))
                .filter(el => !!el);
            dateInputs.forEach(input => {
                input.setAttribute('min', today);
            });
            // Ajuster min de endDate quand startDate change (form)
            const startDateEl = document.getElementById('startDate');
            const endDateEl = document.getElementById('endDate');
            if (startDateEl && endDateEl) {
                startDateEl.addEventListener('change', () => {
                    if (startDateEl.value) {
                        endDateEl.min = startDateEl.value;
                        if (endDateEl.value && endDateEl.value < startDateEl.value) {
                            endDateEl.value = '';
                        }
                    }
                });
            }
            // Ajuster min de searchEndDate selon searchStartDate
            const searchStartEl = document.getElementById('searchStartDate');
            const searchEndEl = document.getElementById('searchEndDate');
            if (searchStartEl && searchEndEl) {
                searchStartEl.addEventListener('change', () => {
                    if (searchStartEl.value) {
                        searchEndEl.min = searchStartEl.value;
                        if (searchEndEl.value && searchEndEl.value < searchStartEl.value) {
                            searchEndEl.value = '';
                        }
                    }
                });
            }
        }

        // Appliquer statut r√©serv√© pour les voitures ayant une r√©servation aujourd'hui
        function applyTodayReservationsStatus() {
            const todayStr = todayLocal();
            for (const carId in carsDatabase) {
                const car = carsDatabase[carId];
                const isReservedToday = car.reservations.some(r => todayStr >= r.startDate && todayStr <= r.endDate);
                const card = document.querySelector(`[data-car-id="${carId}"]`);
                if (card) {
                    const statusEl = card.querySelector('.car-status');
                    const btnEl = card.querySelector('.reserve-btn');
                    if (isReservedToday) {
                        statusEl.textContent = 'R√©serv√©';
                        statusEl.className = 'car-status status-reserved';
                        btnEl.disabled = true;
                    } else {
                        statusEl.textContent = 'Disponible';
                        statusEl.className = 'car-status status-available';
                        btnEl.disabled = false;
                    }
                }
            }
        }

        // Recharger les exemples de r√©servations (r√©initialise et r√©-applique)
        function seedSampleReservations() {
            // R√©injecter les jeux de donn√©es (futures uniquement)
            carsDatabase.car1.reservations = [
                { id: 'r1c1', startDate: '2025-11-10', endDate: '2025-11-12' },
                { id: 'r2c1', startDate: '2025-11-18', endDate: '2025-11-19' }
            ];
            carsDatabase.car2.reservations = [
                { id: 'r1c2', startDate: '2025-11-13', endDate: '2025-11-16' }
            ];
            carsDatabase.car3.reservations = [
                { id: 'r1c3', startDate: '2025-11-20', endDate: '2025-11-25' }
            ];
            carsDatabase.car4.reservations = [
                { id: 'r1c4', startDate: '2025-11-06', endDate: '2025-11-08' }
            ];
            carsDatabase.car5.reservations = [
                { id: 'r1c5', startDate: '2025-12-05', endDate: '2025-12-10' }
            ];

            applyTodayReservationsStatus();
            console.log('üß™ Exemples de r√©servations charg√©s');
            try {
                if (typeof showCenterAlert === 'function') {
                    showCenterAlert('üß™ Exemples charg√©s', 'Les r√©servations de test ont √©t√© r√©initialis√©es. Lancez une recherche de dates qui chevauchent ces p√©riodes pour v√©rifier le filtre.', false);
                }
            } catch (e) {
                // Fallback
            }
        }

        document.addEventListener('DOMContentLoaded', async () => {
            setDynamicMinDates();
            
            // Charger les voitures depuis l'API
            await loadCarsFromAPI();
            
            // Appliquer le statut des r√©servations apr√®s chargement
            applyTodayReservationsStatus();
        });

        // Fonctions de gestion de la disponibilit√©
        function isCarAvailable(carId, startDate, endDate) {
            const car = carsDatabase[carId];
            if (!car) return false;

            const searchStart = new Date(startDate);
            const searchEnd = new Date(endDate);

            // V√©rifier si la p√©riode demand√©e chevauche avec les r√©servations existantes
            for (const reservation of car.reservations) {
                const resStart = new Date(reservation.startDate);
                const resEnd = new Date(reservation.endDate);

                // V√©rifier le chevauchement
                if (searchStart <= resEnd && searchEnd >= resStart) {
                    return false;
                }
            }
            return true;
        }

        // Nouvelle fonction qui v√©rifie la disponibilit√© via l'API
        async function isCarAvailableAPI(carId, startDate, endDate) {
            try {
                // R√©cup√©rer toutes les r√©servations pour cette voiture depuis l'API
                const response = await fetch(`http://localhost:3001/reservations?carId=${carId}`);
                if (!response.ok) {
                    console.warn('‚ö†Ô∏è API non disponible, utilisation de la v√©rification locale');
                    // Fallback: utiliser la v√©rification locale
                    return isCarAvailable(carId, startDate, endDate);
                }
                
                const reservations = await response.json();
                const searchStart = new Date(startDate);
                const searchEnd = new Date(endDate);

                // V√©rifier SEULEMENT les r√©servations accept√©es (ignorer pending et refused)
                const acceptedReservations = reservations.filter(r => r.status === 'accepted');
                
                console.log(`üîç Checking availability for car ${carId}: ${acceptedReservations.length} accepted reservations`);

                // V√©rifier si la p√©riode demand√©e chevauche avec les r√©servations accept√©es
                for (const reservation of acceptedReservations) {
                    const resStart = new Date(reservation.startDate);
                    const resEnd = new Date(reservation.endDate);

                    // V√©rifier le chevauchement
                    if (searchStart <= resEnd && searchEnd >= resStart) {
                        console.log(`‚ùå Conflit de r√©servation trouv√© pour ${carId}:`, reservation);
                        return false;
                    }
                }
                
                console.log(`‚úÖ Voiture ${carId} disponible pour ${startDate} - ${endDate}`);
                return true;
            } catch (error) {
                console.warn('‚ö†Ô∏è Erreur API, utilisation de la v√©rification locale:', error.message);
                // Fallback: utiliser la v√©rification locale
                return isCarAvailable(carId, startDate, endDate);
            }
        }

        // Ancienne fonction (gard√©e pour compatibilit√©)
        function getAvailableCars(startDate, endDate) {
            const availableCars = [];
            
            for (const carId in carsDatabase) {
                if (isCarAvailable(carId, startDate, endDate)) {
                    availableCars.push({
                        ...carsDatabase[carId],
                        element: document.querySelector(`[data-car-id="${carId}"]`)
                    });
                }
            }
            
            return availableCars;
        }

        // Nouvelle fonction qui utilise l'API
        async function getAvailableCarsAPI(startDate, endDate) {
            const availableCars = [];
            
            for (const carId in carsDatabase) {
                const isAvailable = await isCarAvailableAPI(carId, startDate, endDate);
                if (isAvailable) {
                    availableCars.push({
                        ...carsDatabase[carId],
                        element: document.querySelector(`[data-car-id="${carId}"]`)
                    });
                }
            }
            
            return availableCars;
        }

        function updateCarDisplay(availableCars = null) {
            const allCarCards = document.querySelectorAll('.car-card');
            const apologizeMessage = document.getElementById('apologizeMessage');
            const availabilityInfo = document.getElementById('availabilityInfo');
            
            if (!availableCars) {
                // Afficher toutes les voitures avec leur statut par d√©faut (disponibles)
                allCarCards.forEach(card => {
                    card.style.display = 'block';
                    // Restaurer le statut par d√©faut (disponibles)
                    const statusElement = card.querySelector('.car-status');
                    const buttonElement = card.querySelector('.reserve-btn');
                    statusElement.textContent = 'Disponible';
                    statusElement.className = 'car-status status-available';
                    buttonElement.disabled = false;
                });
                apologizeMessage.style.display = 'none'; // Masquer le message d'excuse
                availabilityInfo.style.display = 'none';
                return;
            }

            // Cacher le message d'excuse quand on fait une recherche
            apologizeMessage.style.display = 'none';

            // Cacher toutes les cartes et r√©initialiser leur statut
            allCarCards.forEach(card => {
                card.style.display = 'none';
                const statusElement = card.querySelector('.car-status');
                const buttonElement = card.querySelector('.reserve-btn');
                statusElement.textContent = 'R√©serv√©';
                statusElement.className = 'car-status status-reserved';
                buttonElement.disabled = true;
            });

            // Afficher seulement les voitures disponibles avec le bon statut
            availableCars.forEach((car) => {
                const cardElement = document.querySelector(`[data-car-id="${car.id}"]`);
                if (cardElement) {
                    cardElement.style.display = 'block';
                    
                    // Mettre √† jour le statut pour les voitures disponibles
                    const statusElement = cardElement.querySelector('.car-status');
                    const buttonElement = cardElement.querySelector('.reserve-btn');
                    
                    statusElement.textContent = 'Disponible';
                    statusElement.className = 'car-status status-available';
                    buttonElement.disabled = false;
                    
                    console.log(`‚úÖ ${car.name} (${car.id}) - Statut: Disponible, Bouton: Activ√©`);
                }
            });

            // Mettre √† jour les informations de disponibilit√©
            const availabilityText = document.getElementById('availabilityText');
            
            if (availableCars.length === 0) {
                // Afficher l'alerte centrale au lieu de la petite √©tiquette
                showCenterAlert(
                    'error',
                    'Aucune voiture disponible',
                    `Aucune voiture n'est disponible pour la p√©riode du ${formatDateFrench(startDate)} au ${formatDateFrench(endDate)}. Essayez d'autres dates.`,
                    '‚ùå'
                );
                
                // Masquer la petite info box
                availabilityInfo.style.display = 'none';
            } else {
                const carNames = availableCars.map(car => car.name).join(', ');
                availabilityText.innerHTML = `‚úÖ ${availableCars.length} voiture(s) disponible(s)<br><small><strong>${carNames}</strong></small>`;
                availabilityInfo.style.backgroundColor = '#d4edda';
                availabilityInfo.style.borderLeft = '4px solid #38a169';
                availabilityInfo.style.display = 'block';
            }
            
            availabilityInfo.style.display = 'block';
        }

        async function addReservation(carId, startDate, endDate, customerName, customerEmail) {
            try {
                // Calculer le prix total
                const car = carsDatabase[carId];
                if (!car) {
                    console.error('Voiture non trouv√©e:', carId);
                    return false;
                }
                
                const start = new Date(startDate);
                const end = new Date(endDate);
                const days = Math.ceil((end - start) / (1000 * 60 * 60 * 24));
                
                // Calculer le prix avec les remises progressives et modifiers
                let totalPrice = car.price * days;
                
                // Appliquer les remises progressives
                if (days >= 30) {
                    totalPrice *= 0.6; // 40% de r√©duction
                } else if (days >= 15) {
                    totalPrice *= 0.7; // 30% de r√©duction
                } else if (days >= 8) {
                    totalPrice *= 0.8; // 20% de r√©duction
                } else if (days >= 4) {
                    totalPrice *= 0.9; // 10% de r√©duction
                }
                
                totalPrice = Math.round(totalPrice);
                
                // Pr√©parer les donn√©es de r√©servation pour l'API
                const reservationData = {
                    carId,
                    startDate,
                    endDate,
                    customerName,
                    customerEmail,
                    customerPhone: '+213 771 39 14 80', // Valeur par d√©faut
                    totalPrice,
                    createdAt: new Date().toISOString()
                };
                
                // Envoyer √† l'API
                const response = await fetch('http://localhost:3001/reservations', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(reservationData)
                });
                
                if (response.ok) {
                    const savedReservation = await response.json();
                    console.log(`‚úÖ R√©servation ajout√©e via API pour ${carId}:`, savedReservation);
                    return true;
                } else {
                    console.error('Erreur API lors de l\'ajout de r√©servation:', response.status);
                    return false;
                }
                
            } catch (error) {
                console.error('Erreur lors de l\'ajout de la r√©servation via API:', error);
                return false;
            }
        }

        // Gestionnaires d'√©v√©nements pour la recherche
        document.getElementById('searchAvailability').addEventListener('click', async function() {
            const startDate = document.getElementById('searchStartDate').value;
            const endDate = document.getElementById('searchEndDate').value;
            const departureAgency = document.getElementById('searchDepartureAgency').value;
            const returnAgency = document.getElementById('searchReturnAgency').value;
            const today = todayLocal();

            // Validation de l'agence de d√©part (OBLIGATOIRE)
            if (!departureAgency) {
                alert('‚ö†Ô∏è Veuillez s√©lectionner une agence de d√©part.');
                document.getElementById('searchDepartureAgency').focus();
                return;
            }

            // Validation de l'agence de retour (OBLIGATOIRE)
            if (!returnAgency) {
                alert('‚ö†Ô∏è Veuillez s√©lectionner une agence de retour.');
                document.getElementById('searchReturnAgency').focus();
                return;
            }

            if (!startDate || !endDate) {
                alert('Veuillez s√©lectionner les dates de d√©but et de fin.');
                return;
            }

            // V√©rifier que la date de d√©but n'est pas dans le pass√©
            if (startDate < today) {
                alert('‚ö†Ô∏è La date de d√©but ne peut pas √™tre dans le pass√©. Veuillez s√©lectionner une date √† partir d\'aujourd\'hui.');
                return;
            }

            if (new Date(startDate) >= new Date(endDate)) {
                alert('La date de fin doit √™tre post√©rieure √† la date de d√©but.');
                return;
            }

            // Sauvegarder les dates de recherche ET les agences
            currentSearchDates.startDate = startDate;
            currentSearchDates.endDate = endDate;
            currentSearchDates.departureAgency = departureAgency;
            currentSearchDates.returnAgency = returnAgency;

            console.log(`üîç Recherche de disponibilit√© du ${startDate} au ${endDate} (via API)`);
            
            // Afficher un indicateur de chargement
            this.disabled = true;
            this.textContent = 'Recherche en cours...';
            
            try {
                const availableCars = await getAvailableCarsAPI(startDate, endDate);
                
                console.log('Voitures disponibles (API):', availableCars.map(car => `${car.name} (${car.id})`));
                
                updateCarDisplay(availableCars);
                
                // Scroll vers les r√©sultats
                document.querySelector('.main-content').scrollIntoView({ behavior: 'smooth' });
            } catch (error) {
                console.error('Erreur lors de la recherche:', error);
                alert('‚ùå Erreur lors de la recherche. Veuillez r√©essayer.');
            } finally {
                // Restaurer le bouton
                this.disabled = false;
                this.textContent = 'üîç Rechercher la disponibilit√©';
            }
        });

        document.getElementById('resetSearch').addEventListener('click', function() {
            document.getElementById('searchStartDate').value = '';
            document.getElementById('searchEndDate').value = '';
            document.getElementById('searchDepartureAgency').value = '';
            document.getElementById('searchReturnAgency').value = '';
            
            // R√©initialiser les dates de recherche et les agences
            currentSearchDates.startDate = null;
            currentSearchDates.endDate = null;
            currentSearchDates.departureAgency = null;
            currentSearchDates.returnAgency = null;
            
            // R√©initialiser l'affichage SANS d√©clencher les alertes
            resetToDefaultDisplay();
            
            console.log('üîÑ Recherche r√©initialis√©e - retour √† l\'affichage par d√©faut');
        });

        // Bouton pour recharger les r√©servations d'exemple
        // Seed button supprim√© (suppression du listener)

        // Validation des dates de recherche
        // Bloquer les dates pass√©es en temps r√©el (√©v√©nement input)
        document.getElementById('searchStartDate').addEventListener('input', function() {
            const today = todayLocal();
            if (this.value && this.value < today) {
                this.value = today;
            }
        });

        document.getElementById('searchEndDate').addEventListener('input', function() {
            const today = todayLocal();
            const startDate = document.getElementById('searchStartDate').value;
            
            if (this.value && this.value < today) {
                this.value = today;
            }
            
            if (this.value && startDate && this.value <= startDate) {
                this.value = '';
            }
        });

        // Validation finale au changement (change event)
        document.getElementById('searchStartDate').addEventListener('change', function() {
            const startDate = this.value;
            const endDateInput = document.getElementById('searchEndDate');
            const today = todayLocal();
            
            // Bloquer la s√©lection de dates dans le pass√©
            if (startDate && startDate < today) {
                alert('‚ö†Ô∏è Vous ne pouvez pas s√©lectionner une date dans le pass√©.\nLa date a √©t√© r√©initialis√©e √† aujourd\'hui.');
                this.value = today;
                return;
            }
            
            if (startDate) {
                // Mettre √† jour la date minimum de fin
                endDateInput.min = startDate;
                
                // R√©initialiser la date de fin si elle est invalide
                if (endDateInput.value && endDateInput.value <= startDate) {
                    endDateInput.value = '';
                }
            }
        });

        // Validation de la date de fin
        document.getElementById('searchEndDate').addEventListener('change', function() {
            const endDate = this.value;
            const startDateInput = document.getElementById('searchStartDate');
            const today = todayLocal();
            
            // Bloquer la s√©lection de dates dans le pass√©
            if (endDate && endDate < today) {
                alert('‚ö†Ô∏è Vous ne pouvez pas s√©lectionner une date dans le pass√©.\nLa date a √©t√© r√©initialis√©e √† aujourd\'hui.');
                this.value = today;
                return;
            }
            
            // V√©rifier que la date de fin est apr√®s la date de d√©but
            if (endDate && startDateInput.value && endDate <= startDateInput.value) {
                alert('‚ö†Ô∏è La date de fin doit √™tre apr√®s la date de d√©but.');
                this.value = '';
            }
        });

        // Ouvrir la modal au clic sur "R√©server" (d√©l√©gation d'√©v√©nement)
        // Nouveau gestionnaire: ouverture popup rapide au clic sur R√©server
        document.addEventListener('click', function(e) {
            if (e.target && e.target.classList.contains('reserve-btn') && !e.target.disabled) {
                const carName = e.target.getAttribute('data-car');
                const carPrice = parseInt(e.target.getAttribute('data-price'), 10);
                const carId = e.target.closest('.car-card').getAttribute('data-car-id');
                const quickModal = document.getElementById('quickReservationModal');
                quickModal.setAttribute('data-car-id', carId);
                quickModal.setAttribute('data-car-price', carPrice);
                document.getElementById('quickCarName').textContent = `${carName}`;
                document.getElementById('quickDailyRate').textContent = `${carPrice}‚Ç¨`; 
                // Init dates
                const today = todayLocal();
                const qs = document.getElementById('quickStart');
                const qe = document.getElementById('quickEnd');
                const qDep = document.getElementById('quickDepartureAgency');
                const qRet = document.getElementById('quickReturnAgency');
                qs.min = today; qe.min = today;
                if (currentSearchDates.startDate && currentSearchDates.endDate) {
                    qs.value = currentSearchDates.startDate;
                    qe.value = currentSearchDates.endDate;
                } else { qs.value=''; qe.value=''; }
                // Pr√©-remplir les agences depuis la recherche
                if (currentSearchDates.departureAgency) {
                    qDep.value = currentSearchDates.departureAgency;
                } else {
                    qDep.value = '';
                }
                if (currentSearchDates.returnAgency) {
                    qRet.value = currentSearchDates.returnAgency;
                } else {
                    qRet.value = '';
                }
                document.getElementById('quickPriceBox').style.display='none';
                document.getElementById('quickError').style.display='none';
                quickModal.style.display='block';
                document.body.style.overflow='hidden';
                
                // Calculate and show price if dates are pre-filled
                if (currentSearchDates.startDate && currentSearchDates.endDate) {
                    updateQuickPrice();
                }
            }
        });

        // Fermer popup rapide
        function closeQuickModal() {
            const quickModal = document.getElementById('quickReservationModal');
            quickModal.style.display = 'none';
            document.body.style.overflow = 'auto';
        }
        document.getElementById('quickCloseBtn').addEventListener('click', closeQuickModal);
        document.getElementById('quickCancelBtn').addEventListener('click', closeQuickModal);
        window.addEventListener('click', function(ev){
            const quickModal = document.getElementById('quickReservationModal');
            if (ev.target === quickModal) closeQuickModal();
        });

        // Mise √† jour bo√Æte de prix (jour & total)
        function updateQuickPrice() {
            const qsVal = document.getElementById('quickStart').value;
            const qeVal = document.getElementById('quickEnd').value;
            const quickModal = document.getElementById('quickReservationModal');
            const box = document.getElementById('quickPriceBox');
            const err = document.getElementById('quickError');
            const carId = quickModal.getAttribute('data-car-id');
            const breakdownDiv = document.getElementById('quickBreakdown');
            const breakdownDaysDiv = document.getElementById('quickBreakdownDays');
            const discountRow = document.getElementById('quickDiscountRow');
            const subtotalRow = document.getElementById('quickSubtotal');
            
            err.style.display='none';
            discountRow.style.display='none'; // Cacher la r√©duction par d√©faut
            
            if (!qsVal || !qeVal) { box.style.display='none'; return; }
            const start = new Date(qsVal); const end = new Date(qeVal);
            if (start >= end) { box.style.display='none'; err.textContent='Dates invalides'; err.style.display='block'; return; }
            
            const pricePerDay = parseInt(quickModal.getAttribute('data-car-price'),10);
            const days = Math.ceil((end - start)/(1000*60*60*24));
            
            // TOUTES LES VOITURES : utiliser le calcul avec majoration weekend + r√©duction longue dur√©e
            if (typeof window.calculateCarPriceWithWeekend === 'function') {
                try {
                    const result = window.calculateCarPriceWithWeekend(carId, qsVal, qeVal, true); // true = appliquer r√©ductions
                    
                    // Afficher le tarif journalier de base
                    document.getElementById('quickDailyRate').textContent = `${result.baseRate}‚Ç¨/jour`;
                    
                    // Afficher le sous-total (base + weekend)
                    document.getElementById('quickSubtotalPrice').textContent = `${result.subtotal}‚Ç¨ (${result.days}j)`;
                    
                    // Afficher la r√©duction si applicable
                    if (result.hasDiscount) {
                        document.getElementById('quickDiscountLabel').textContent = result.discountLabel;
                        document.getElementById('quickDiscountAmount').textContent = `-${result.discountAmount}‚Ç¨`;
                        discountRow.style.display = 'block';
                        subtotalRow.style.display = 'flex'; // Afficher le sous-total si r√©duction
                    } else {
                        subtotalRow.style.display = 'none'; // Cacher le sous-total si pas de r√©duction
                    }
                    
                    // Afficher le prix final
                    const weekendInfo = result.weekendExtra > 0 ? ` (dont ${result.weekendExtra}‚Ç¨ weekend)` : '';
                    document.getElementById('quickTotalPrice').textContent = `${result.total}‚Ç¨${weekendInfo}`;
                    
                    // Afficher le d√©tail jour par jour
                    let breakdownHTML = '';
                    result.breakdown.forEach(day => {
                        const dayName = new Date(day.date).toLocaleDateString('fr-FR', { weekday: 'short', day: '2-digit', month: 'short' });
                        const isWeekend = day.isWeekend;
                        const bgColor = isWeekend ? '#fff3cd' : 'white';
                        const borderColor = isWeekend ? '#fd7e14' : '#e9ecef';
                        const badge = isWeekend ? '<span style="font-size:.65rem; color:#fd7e14; font-weight:600;">üî∂ WEEKEND</span>' : '';
                        breakdownHTML += `
                            <div style="display:flex; justify-content:space-between; align-items:center; padding:.4rem .5rem; margin:.2rem 0; background:${bgColor}; border-left:3px solid ${borderColor}; border-radius:4px; font-size:.75rem;">
                                <span style="text-transform:capitalize;">${dayName}</span>
                                <div style="display:flex; align-items:center; gap:.4rem;">
                                    ${badge}
                                    <strong style="color:#333;">${day.price}‚Ç¨</strong>
                                </div>
                            </div>
                        `;
                    });
                    breakdownDaysDiv.innerHTML = breakdownHTML;
                    breakdownDiv.style.display = 'block';
                    box.style.display='block';
                    return;
                } catch (error) {
                    console.error('Erreur calcul prix weekend:', error);
                    // Fallback vers calcul simple si erreur
                }
            }
            
            // Fallback: calcul simple sans breakdown (ne devrait plus arriver)
            breakdownDiv.style.display = 'none';
            subtotalRow.style.display = 'none';
            let total = pricePerDay * days;
            document.getElementById('quickTotalPrice').textContent = `${total}‚Ç¨ (${days}j)`;
            box.style.display='block';
        }
        document.getElementById('quickStart').addEventListener('change', function(){
            const qe = document.getElementById('quickEnd');
            if (this.value) { qe.min = this.value; if (qe.value && qe.value <= this.value) qe.value=''; }
            updateQuickPrice();
        });
    document.getElementById('quickEnd').addEventListener('change', updateQuickPrice);

        // Redirection vers page de paiement
        document.getElementById('quickPayBtn').addEventListener('click', async function(){
            const quickModal = document.getElementById('quickReservationModal');
            const carId = quickModal.getAttribute('data-car-id');
            const startDate = document.getElementById('quickStart').value;
            const endDate = document.getElementById('quickEnd').value;
            const departureAgency = document.getElementById('quickDepartureAgency').value;
            const returnAgency = document.getElementById('quickReturnAgency').value;
            const err = document.getElementById('quickError');
            
            // Validation de l'agence de d√©part
            if (!departureAgency) { 
                err.textContent='‚ö†Ô∏è Veuillez s√©lectionner une agence de d√©part'; 
                err.style.display='block'; 
                document.getElementById('quickDepartureAgency').focus();
                return; 
            }
            
            // Validation de l'agence de retour
            if (!returnAgency) { 
                err.textContent='‚ö†Ô∏è Veuillez s√©lectionner une agence de retour'; 
                err.style.display='block'; 
                document.getElementById('quickReturnAgency').focus();
                return; 
            }
            
            if (!startDate || !endDate) { err.textContent='S√©lectionnez les dates'; err.style.display='block'; return; }
            if (new Date(startDate) >= new Date(endDate)) { err.textContent='Dates invalides'; err.style.display='block'; return; }
            // V√©rifier disponibilit√© avant paiement
            const avail = await isCarAvailableAPI(carId, startDate, endDate);
            if (!avail) { err.textContent='Cette voiture est d√©j√† r√©serv√©e pour ces dates.'; err.style.display='block'; return; }
            
            // Recalcul du total avec r√©duction longue dur√©e
            const pricePerDay = parseInt(quickModal.getAttribute('data-car-price'),10);
            const days = Math.ceil((new Date(endDate) - new Date(startDate))/(1000*60*60*24));
            let total = pricePerDay * days;
            
            // TOUTES LES VOITURES : utiliser le calcul avec majoration weekend + r√©duction
            if (typeof window.calculateCarPriceWithWeekend === 'function') {
                try {
                    const result = window.calculateCarPriceWithWeekend(carId, startDate, endDate, true); // true = appliquer r√©ductions
                    total = result.total; // Prix final avec r√©duction appliqu√©e
                } catch (error) {
                    console.error('Erreur calcul prix weekend pour paiement:', error);
                    // Utiliser le calcul simple en fallback
                }
            }
            
            const params = new URLSearchParams({ 
                carId, 
                start: startDate, 
                end: endDate, 
                days: String(days), 
                total: String(total),
                departureAgency: departureAgency,
                returnAgency: returnAgency
            });
            window.location.href = `payment.html?${params.toString()}`;
        });


        // Fermer la modal
        function closeModal() {
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
            form.reset();
            successMessage.style.display = 'none';
        }

        closeBtn.addEventListener('click', closeModal);
        cancelBtn.addEventListener('click', closeModal);

        // Fermer la modal en cliquant √† l'ext√©rieur
        window.addEventListener('click', function(event) {
            if (event.target === modal) {
                closeModal();
            }
        });

        // Validation des dates
        document.getElementById('startDate').addEventListener('change', function() {
            const startDate = this.value;
            const endDateInput = document.getElementById('endDate');
            const today = todayLocal();
            
            // V√©rifier si la date s√©lectionn√©e est dans le pass√©
            if (startDate && startDate < today) {
                alert('‚ö†Ô∏è Attention: Vous ne pouvez pas s√©lectionner une date dans le pass√©. La date a √©t√© r√©initialis√©e √† aujourd\'hui.');
                this.value = today;
                return;
            }
            
            if (startDate) {
                endDateInput.min = startDate;
                
                // Si la date de fin est ant√©rieure √† la date de d√©but, la r√©initialiser
                if (endDateInput.value && endDateInput.value < startDate) {
                    endDateInput.value = '';
                }
            }
        });

        // Gestion de la soumission du formulaire
        form.addEventListener('submit', async function(event) {
            event.preventDefault();
            
            // Simulation d'envoi (remplacez par votre logique backend)
            const formData = new FormData(form);
            const reservationData = {
                carName: formData.get('carName'),
                customerName: formData.get('customerName'),
                customerEmail: formData.get('customerEmail'),
                startDate: formData.get('startDate'),
                endDate: formData.get('endDate')
            };

            // Validation basique
            if (!reservationData.customerName || !reservationData.customerEmail || 
                !reservationData.startDate || !reservationData.endDate) {
                alert('Veuillez remplir tous les champs obligatoires.');
                return;
            }

            // Validation de la date
            const start = new Date(reservationData.startDate);
            const end = new Date(reservationData.endDate);
            const today = new Date();
            today.setHours(0, 0, 0, 0); // R√©initialiser l'heure pour comparer seulement les dates
            
            // V√©rifier que la date de d√©but n'est pas dans le pass√©
            if (start < today) {
                alert('La date de d√©but ne peut pas √™tre dans le pass√©. Veuillez choisir une date √† partir d\'aujourd\'hui.');
                return;
            }
            
            if (end <= start) {
                alert('La date de fin doit √™tre post√©rieure √† la date de d√©but.');
                return;
            }

            // Simulation d'un d√©lai d'envoi
            const submitBtn = form.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            
            submitBtn.disabled = true;
            submitBtn.textContent = 'Envoi en cours...';
            
            // R√©cup√©rer l'ID de la voiture s√©lectionn√©e
            const selectedCarId = form.getAttribute('data-selected-car-id');
            
            // Processus asynchrone de r√©servation
            (async () => {
                try {
                    // V√©rifier la disponibilit√© avant d'enregistrer via l'API
                    const isAvailable = await isCarAvailableAPI(selectedCarId, reservationData.startDate, reservationData.endDate);
                    
                    if (!isAvailable) {
                        alert('‚ùå D√©sol√©, cette voiture n\'est plus disponible pour les dates s√©lectionn√©es. Veuillez choisir d\'autres dates.');
                        submitBtn.disabled = false;
                        submitBtn.textContent = originalText;
                        return;
                    }
                    
                    // Enregistrer la r√©servation dans la base de donn√©es via l'API
                    const success = await addReservation(
                        selectedCarId,
                        reservationData.startDate,
                            reservationData.endDate,
                        reservationData.customerName,
                        reservationData.customerEmail
                    );
                    
                    if (success) {
                        // Afficher le message de succ√®s
                        successMessage.style.display = 'block';
                        
                        // Calculer le nombre de jours et le prix total
                        const days = Math.ceil((end - start) / (1000 * 60 * 60 * 24));
                        const car = carsDatabase[selectedCarId];
                        let totalPrice = car.price * days;
                        
                        // Appliquer les remises progressives (m√™me logique que dans addReservation)
                        if (days >= 30) {
                            totalPrice *= 0.6; // 40% de r√©duction
                        } else if (days >= 15) {
                            totalPrice *= 0.7; // 30% de r√©duction
                        } else if (days >= 8) {
                            totalPrice *= 0.8; // 20% de r√©duction
                        } else if (days >= 4) {
                            totalPrice *= 0.9; // 10% de r√©duction
                        }
                        
                        totalPrice = Math.round(totalPrice);
                        
                        console.log('‚úÖ R√©servation confirm√©e:', {
                            ...reservationData,
                            carId: selectedCarId,
                            days,
                            totalPrice: totalPrice + '‚Ç¨'
                        });
                        
                        // Mettre √† jour l'affichage si une recherche est active
                        const searchStartDate = document.getElementById('searchStartDate').value;
                        const searchEndDate = document.getElementById('searchEndDate').value;
                        if (searchStartDate && searchEndDate) {
                            // TODO: Mettre √† jour la recherche avec l'API
                            console.log('üîÑ Recherche √† actualiser avec nouvelle r√©servation');
                        }
                        
                        // Fermer la modal apr√®s 2 secondes
                        setTimeout(() => {
                            closeModal();
                        }, 2000);
                    } else {
                        alert('‚ùå Erreur lors de l\'enregistrement de la r√©servation.');
                    }
                    
                } catch (error) {
                    console.error('Erreur lors du processus de r√©servation:', error);
                    alert('‚ùå Erreur technique lors de la r√©servation. Veuillez r√©essayer.');
                }
                
                // R√©initialiser le bouton
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            })();
        });

        // Menu mobile (fonctionnalit√© basique)
        const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
        const nav = document.querySelector('.nav');

        mobileMenuBtn.addEventListener('click', function() {
            nav.style.display = nav.style.display === 'flex' ? 'none' : 'flex';
        });

        // Smooth scroll pour les liens de navigation
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth'
                    });
                }
            });
        });

        // Animation d'apparition des cartes au scroll (bonus)
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver(function(entries) {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);

        // Appliquer l'animation aux cartes
        document.querySelectorAll('.car-card').forEach(card => {
            card.style.opacity = '0';
            card.style.transform = 'translateY(30px)';
            card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
            observer.observe(card);
        });

        // Gestion du redimensionnement de fen√™tre
        window.addEventListener('resize', function() {
            if (window.innerWidth > 768) {
                nav.style.display = 'flex';
            } else {
                nav.style.display = 'none';
            }
        });

        // V√©rifier le statut des voitures pour aujourd'hui
        function checkTodayAvailability() {
            const today = todayLocal();
            let availableToday = 0;
            
            Object.keys(carsDatabase).forEach((carId, index) => {
                const isAvailable = isCarAvailable(carId, today, today);
                const cardElement = document.querySelector(`[data-car-id="${carId}"]`);
                
                if (cardElement) {
                    const statusElement = cardElement.querySelector('.car-status');
                    const buttonElement = cardElement.querySelector('.reserve-btn');
                    
                    if (isAvailable) {
                        statusElement.textContent = 'Disponible';
                        statusElement.className = 'car-status status-available';
                        buttonElement.disabled = false;
                        availableToday++;
                        console.log(`‚úÖ ${carsDatabase[carId].name} - Disponible aujourd'hui`);
                    } else {
                        statusElement.textContent = 'R√©serv√©';
                        statusElement.className = 'car-status status-reserved';
                        buttonElement.disabled = true;
                        console.log(`‚ùå ${carsDatabase[carId].name} - R√©serv√© aujourd'hui`);
                    }
                }
            });
            
            console.log(`üìä Aujourd'hui (${today}): ${availableToday} voiture(s) disponible(s) sur ${Object.keys(carsDatabase).length}`);
            
            // G√©rer le message d'excuse
            const apologizeMessage = document.getElementById('apologizeMessage');
            if (availableToday > 0) {
                console.log('üü¢ Masquer le message d\'excuse - voitures disponibles');
                apologizeMessage.style.display = 'none';
            } else {
                console.log('üî¥ Aucune voiture disponible aujourd\'hui - afficher alerte centrale');
                apologizeMessage.style.display = 'none'; // Masquer le message statique
                
                // Afficher l'alerte centrale
                setTimeout(() => {
                    showCenterAlert(
                        'error',
                        'Aucune voiture disponible aujourd\'hui',
                        `Nous nous excusons, toutes nos voitures sont r√©serv√©es pour aujourd'hui (${formatDateFrench(today)}). Essayez de rechercher pour d'autres dates ou revenez demain !`,
                        'üòî'
                    );
                }, 500); // Petit d√©lai pour que la page se charge compl√®tement
            }
            
            return availableToday;
        }

        // Charger les donn√©es depuis localStorage si disponibles
        function loadDatabaseFromStorage() {
            try {
                const saved = localStorage.getItem('fandiapp_reservations');
                if (saved) {
                    const savedData = JSON.parse(saved);
                    // Fusionner les donn√©es sauvegard√©es
                    Object.keys(carsDatabase).forEach(carId => {
                        if (savedData[carId] && savedData[carId].reservations) {
                            carsDatabase[carId].reservations = savedData[carId].reservations;
                        }
                    });
                    console.log('üìÅ Base de donn√©es synchronis√©e depuis localStorage');
                    return true;
                }
            } catch (error) {
                console.error('Erreur lors du chargement depuis localStorage:', error);
            }
            return false;
        }

        // Surveiller les changements depuis l'admin avec notification
        function watchForAdminUpdates() {
            let lastUpdate = localStorage.getItem('fandiapp_last_update');
            
            setInterval(() => {
                const currentUpdate = localStorage.getItem('fandiapp_last_update');
                if (currentUpdate && currentUpdate !== lastUpdate) {
                    lastUpdate = currentUpdate;
                    console.log('üîÑ Mise √† jour d√©tect√©e depuis l\'admin');
                    loadDatabaseFromStorage();
                    
                    // Afficher notification de mise √† jour en temps r√©el
                    showLiveUpdateNotification();
                    
                    // Remettre √† jour l'affichage selon le contexte
                    if (!currentSearchDates.startDate || !currentSearchDates.endDate) {
                        // Mode affichage par d√©faut - mise √† jour silencieuse
                        resetToDefaultDisplay();
                    } else {
                        // Mode recherche active - relancer la recherche
                        const availableCars = getAvailableCars(currentSearchDates.startDate, currentSearchDates.endDate);
                        updateCarDisplay(availableCars);
                    }
                }
            }, 500); // V√©rification plus rapide (0.5 seconde)
        }

        // Notification en temps r√©el des mises √† jour
        function showLiveUpdateNotification() {
            let notification = document.getElementById('liveUpdateNotification');
            if (!notification) {
                notification = document.createElement('div');
                notification.id = 'liveUpdateNotification';
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: linear-gradient(135deg, #4CAF78 0%, #3a9260 100%);
                    color: white;
                    padding: 0.8rem 1.2rem;
                    border-radius: 25px;
                    font-size: 0.85rem;
                    font-weight: 600;
                    z-index: 1001;
                    box-shadow: 0 4px 15px rgba(76, 175, 120, 0.4);
                    transform: translateX(300px);
                    transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
                    display: flex;
                    align-items: center;
                    gap: 0.5rem;
                    pointer-events: none;
                `;
                document.body.appendChild(notification);
            }

            notification.innerHTML = '‚ú® Donn√©es mises √† jour !';
            notification.style.transform = 'translateX(0)';

            // Animation de sortie apr√®s 3 secondes
            setTimeout(() => {
                notification.style.transform = 'translateX(300px)';
            }, 3000);
        }

        // Auto-refresh pour le d√©veloppement (d√©tecte les changements de fichiers)
        function enableDevLiveReload() {
            if (location.hostname === 'localhost' || location.hostname === '127.0.0.1') {
                console.log('üîß Mode d√©veloppement - Auto-refresh activ√©');
                
                setInterval(() => {
                    fetch(window.location.href + '?t=' + Date.now(), {
                        method: 'HEAD',
                        cache: 'no-cache'
                    }).catch(() => {
                        // Si le serveur ne r√©pond pas, tenter de recharger
                        setTimeout(() => {
                            location.reload();
                        }, 1000);
                    });
                }, 5000); // V√©rifier toutes les 5 secondes
            }
        }

        // Synchronisation am√©lior√©e avec indicateur visuel
        function enhancedSync() {
            // Indicateur de statut de connexion
            const statusIndicator = document.createElement('div');
            statusIndicator.id = 'connectionStatus';
            statusIndicator.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 20px;
                width: 12px;
                height: 12px;
                border-radius: 50%;
                background: #28a745;
                z-index: 1002;
                box-shadow: 0 0 10px rgba(40, 167, 69, 0.6);
                animation: pulse 2s infinite;
            `;
            
            // Animation CSS pour le pulse
            const pulseStyle = document.createElement('style');
            pulseStyle.textContent = `
                @keyframes pulse {
                    0% { box-shadow: 0 0 10px rgba(40, 167, 69, 0.6); }
                    50% { box-shadow: 0 0 20px rgba(40, 167, 69, 0.8); }
                    100% { box-shadow: 0 0 10px rgba(40, 167, 69, 0.6); }
                }
            `;
            document.head.appendChild(pulseStyle);
            document.body.appendChild(statusIndicator);
        }

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Dashboard FandiApp initialis√© avec base de donn√©es ‚úÖ');
            
            // Vider le localStorage pour √©viter les conflits
            localStorage.clear();
            
            // Charger les donn√©es sauvegard√©es
            // loadDatabaseFromStorage(); // D√©sactiv√© - nous utilisons maintenant l'API JSON Server
            
            // Activer la synchronisation en temps r√©el
            watchForAdminUpdates();
            
            // Activer le live reload pour le d√©veloppement
            enableDevLiveReload();
            
            // Ajouter l'indicateur de statut de connexion
            enhancedSync();
            
            // Fonction pour mettre √† jour les dates minimums
            function updateMinDates() {
                const today = todayLocal();
                const searchStartDate = document.getElementById('searchStartDate');
                const searchEndDate = document.getElementById('searchEndDate');
                const startDate = document.getElementById('startDate');
                const endDate = document.getElementById('endDate');
                
                // D√©finir les dates minimum (emp√™che la s√©lection de dates pass√©es)
                if (searchStartDate) searchStartDate.min = today;
                if (searchEndDate) searchEndDate.min = today;
                if (startDate) startDate.min = today;
                if (endDate) endDate.min = today;
                
                console.log('üìÖ Dates minimums mises √† jour √†:', today);
            }
            
            // D√©finir la date minimum √† aujourd'hui pour la recherche ET le modal de r√©servation
            updateMinDates();
            
            // Mettre √† jour les dates chaque jour (si la page reste ouverte)
            setInterval(updateMinDates, 60000); // Toutes les minutes
            
            // Mettre √† jour les dates minimums toutes les heures pour s'assurer qu'elles restent √† jour
            setInterval(updateMinDates, 60 * 60 * 1000); // 1 heure
            
            // V√©rifier et mettre √† jour les statuts pour aujourd'hui
            // checkTodayAvailability(); // D√©sactiv√© temporairement - les voitures s'affichent comme disponibles par d√©faut
            
            console.log('üöÄ Mode LIVE activ√© - Synchronisation automatique en cours...');
            
            // Mettre √† jour les compteurs de disponibilit√©
            const totalCars = Object.keys(carsDatabase).length;
            console.log(`${totalCars} voiture(s) dans la base de donn√©es`);
            console.log('Base de donn√©es:', carsDatabase);
            
            // === EVENT LISTENERS POUR LE CALCUL DE PRIX ===
            
            // Event listener pour le bouton "Calculer le prix"
            document.getElementById('calculatePrice').addEventListener('click', function() {
                const startDate = document.getElementById('startDate').value;
                const endDate = document.getElementById('endDate').value;
                const today = todayLocal();
                
                if (!startDate || !endDate) {
                    alert('Veuillez s√©lectionner les dates de d√©but et de fin');
                    return;
                }
                
                // V√©rifier que la date de d√©but n'est pas dans le pass√©
                if (startDate < today) {
                    alert('‚ö†Ô∏è La date de d√©but ne peut pas √™tre dans le pass√©. Veuillez s√©lectionner une date √† partir d\'aujourd\'hui.');
                    return;
                }
                
                if (new Date(startDate) >= new Date(endDate)) {
                    alert('La date de fin doit √™tre apr√®s la date de d√©but');
                    return;
                }
                
                console.log('üí∞ Calcul de prix demand√©:', { startDate, endDate, currentCarPrice });
                
                // Calculer et afficher le prix
                currentCalculation = calculateRentalPrice(startDate, endDate, currentCarPrice);
                displayPriceCalculation(currentCalculation);
            });

            // Event listeners pour les champs de date (recalcul automatique)
            document.getElementById('startDate').addEventListener('change', function() {
                const endDate = document.getElementById('endDate').value;
                if (endDate && this.value) {
                    // Recalculer automatiquement si les deux dates sont remplies
                    setTimeout(() => {
                        document.getElementById('calculatePrice').click();
                    }, 300);
                }
            });

            document.getElementById('endDate').addEventListener('change', function() {
                const startDate = document.getElementById('startDate').value;
                if (startDate && this.value) {
                    // Recalculer automatiquement si les deux dates sont remplies
                    setTimeout(() => {
                        document.getElementById('calculatePrice').click();
                    }, 300);
                }
            });
            
            // Fermer l'alerte en cliquant sur l'overlay
            document.getElementById('alertOverlay').addEventListener('click', closeCenterAlert);
        });

        // Fonction utilitaire pour formater les dates en fran√ßais
        function formatDateFrench(dateString) {
            const date = new Date(dateString);
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            };
            return date.toLocaleDateString('fr-FR', options);
        }

        // Fonctions pour l'alerte centrale
        function showCenterAlert(type, title, message, icon) {
            const overlay = document.getElementById('alertOverlay');
            const alert = document.getElementById('centerAlert');
            const alertIcon = document.getElementById('alertIcon');
            const alertTitle = document.getElementById('alertTitle');
            const alertMessage = document.getElementById('alertMessage');

            // Mettre √† jour le contenu
            alertIcon.textContent = icon || '‚ùå';
            alertTitle.textContent = title;
            alertMessage.textContent = message;

            // Appliquer le style selon le type
            alert.className = 'center-alert ' + (type || 'error');

            // Afficher l'alerte
            overlay.style.display = 'block';
            alert.style.display = 'block';

            // Auto-fermer apr√®s 5 secondes pour les succ√®s
            if (type === 'success') {
                setTimeout(() => {
                    closeCenterAlert();
                }, 5000);
            }
        }

        function closeCenterAlert() {
            const overlay = document.getElementById('alertOverlay');
            const alert = document.getElementById('centerAlert');
            
            overlay.style.display = 'none';
            alert.style.display = 'none';
        }

        // === SYST√àME DE CALCUL DE PRIX ===

        // Configuration des p√©riodes sp√©ciales
        const pricingConfig = {
            weekendMultiplier: 1.3,      // +30% pour les week-ends
            highSeasonMultiplier: 1.3,   // +30% pour la haute saison
            holidayMultiplier: 1.3,      // +30% pour les vacances
            
            // P√©riodes de haute saison (√©t√©)
            highSeason: {
                start: { month: 6, day: 1 },   // 1er juin
                end: { month: 8, day: 31 }     // 31 ao√ªt
            },
            
            // P√©riodes de vacances (No√´l)
            holidays: [
                {
                    start: { month: 12, day: 20 }, // 20 d√©cembre
                    end: { month: 1, day: 5 }      // 5 janvier (ann√©e suivante)
                }
            ]
        };

        // Variables globales pour le calcul
        let currentCarPrice = 0;
        let currentCalculation = null;

        // Configuration des remises d√©gressives
        const progressiveDiscountTiers = [
            { minDays: 1, maxDays: 3, discount: 0, description: "Prix normal" },
            { minDays: 4, maxDays: 7, discount: 10, description: "Remise semaine (-10%)" },
            { minDays: 8, maxDays: 14, discount: 20, description: "Remise 2 semaines (-20%)" },
            { minDays: 15, maxDays: 30, discount: 30, description: "Remise mensuelle (-30%)" },
            { minDays: 31, maxDays: Infinity, discount: 40, description: "Remise longue dur√©e (-40%)" }
        ];

        // Fonction pour calculer la remise d√©gressive selon la dur√©e
        function calculateProgressiveDiscount(days) {
            for (const tier of progressiveDiscountTiers) {
                if (days >= tier.minDays && days <= tier.maxDays) {
                    return tier;
                }
            }
            return progressiveDiscountTiers[0]; // Par d√©faut, aucune remise
        }

        // Fonction principale de calcul de prix
        function calculateRentalPrice(startDate, endDate, dailyPrice) {
            console.log(`üí∞ Calcul du prix: ${startDate} √† ${endDate}, prix de base: ${dailyPrice}‚Ç¨/jour`);
            
            const start = new Date(startDate);
            const end = new Date(endDate);
            const days = [];
            let totalPrice = 0;
            let basePrice = 0;
            let weekendDays = 0;
            let highSeasonDays = 0;
            let holidayDays = 0;

            // G√©n√©rer tous les jours de la p√©riode
            for (let d = new Date(start); d <= end; d.setDate(d.getDate() + 1)) {
                const currentDay = new Date(d);
                const dayInfo = analyzDay(currentDay);
                
                let dayPrice = dailyPrice;
                let modifier = '';
                
                // Appliquer les r√®gles tarifaires (weekend prioritaire)
                if (dayInfo.isWeekend) {
                    dayPrice *= pricingConfig.weekendMultiplier;
                    weekendDays++;
                    modifier = 'Week-end (+30%)';
                } else if (dayInfo.isHighSeason) {
                    dayPrice *= pricingConfig.highSeasonMultiplier;
                    highSeasonDays++;
                    modifier = 'Haute saison (+30%)';
                } else if (dayInfo.isHoliday) {
                    dayPrice *= pricingConfig.holidayMultiplier;
                    holidayDays++;
                    modifier = 'Vacances (+30%)';
                } else {
                    modifier = 'Normal';
                }

                days.push({
                    date: new Date(currentDay),
                    price: Math.round(dayPrice),
                    basePrice: dailyPrice,
                    modifier: modifier,
                    type: dayInfo.isWeekend ? 'weekend' : 
                          dayInfo.isHighSeason ? 'high-season' :
                          dayInfo.isHoliday ? 'holiday' : 'normal'
                });

                totalPrice += dayPrice;
                basePrice += dailyPrice;
            }

            // NOUVEAU : Calculer la remise d√©gressive sur le prix total (apr√®s majorations)
            const totalDays = days.length;
            const discountInfo = calculateProgressiveDiscount(totalDays);
            const discountAmount = Math.round(totalPrice * (discountInfo.discount / 100));
            const finalPrice = Math.round(totalPrice - discountAmount);

            const calculation = {
                days: days,
                totalDays: totalDays,
                basePrice: basePrice,
                totalPrice: Math.round(totalPrice), // Prix avec majorations week-end/saison
                discountInfo: discountInfo, // Info sur la remise d√©gressive
                discountAmount: discountAmount, // Montant de la remise
                finalPrice: finalPrice, // Prix final apr√®s remise d√©gressive
                weekendDays: weekendDays,
                highSeasonDays: highSeasonDays,
                holidayDays: holidayDays,
                savings: Math.round(basePrice - totalPrice) // √âconomies/majorations saison
            };

            console.log('üìä R√©sultat du calcul avec remise d√©gressive:', calculation);
            return calculation;
        }

        // Analyser un jour pour d√©terminer ses caract√©ristiques
        function analyzDay(date) {
            const dayOfWeek = date.getDay(); // 0 = dimanche, 6 = samedi
            const month = date.getMonth() + 1; // 1-12
            const day = date.getDate();
            const year = date.getFullYear();

            const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;
            
            // V√©rifier haute saison
            const isHighSeason = (month >= pricingConfig.highSeason.start.month && month <= pricingConfig.highSeason.end.month);
            
            // V√©rifier vacances
            let isHoliday = false;
            for (const holiday of pricingConfig.holidays) {
                if (holiday.start.month === 12 && holiday.end.month === 1) {
                    // P√©riode √† cheval sur deux ann√©es (No√´l)
                    if ((month === 12 && day >= holiday.start.day) || 
                        (month === 1 && day <= holiday.end.day)) {
                        isHoliday = true;
                        break;
                    }
                }
            }

            return { isWeekend, isHighSeason, isHoliday };
        }

        // Afficher les r√©sultats du calcul
        function displayPriceCalculation(calculation) {
            const priceDetails = document.getElementById('priceDetails');
            const priceCalendar = document.getElementById('priceCalendar');
            
            // Remplir le r√©sum√©
            document.getElementById('totalDays').textContent = `${calculation.totalDays} jour(s)`;
            document.getElementById('basePrice').textContent = `${calculation.basePrice}‚Ç¨`;
            document.getElementById('totalPrice').textContent = `${calculation.totalPrice}‚Ç¨`;

            // Afficher les lignes sp√©ciales si n√©cessaires
            const weekendLine = document.getElementById('weekendLine');
            const highSeasonLine = document.getElementById('highSeasonLine');
            const holidayLine = document.getElementById('holidayLine');

            weekendLine.style.display = calculation.weekendDays > 0 ? 'flex' : 'none';
            highSeasonLine.style.display = calculation.highSeasonDays > 0 ? 'flex' : 'none';
            holidayLine.style.display = calculation.holidayDays > 0 ? 'flex' : 'none';

            if (calculation.weekendDays > 0) {
                document.getElementById('weekendDays').textContent = `${calculation.weekendDays} jour(s)`;
            }
            if (calculation.highSeasonDays > 0) {
                document.getElementById('highSeasonDays').textContent = `${calculation.highSeasonDays} jour(s)`;
            }
            if (calculation.holidayDays > 0) {
                document.getElementById('holidayDays').textContent = `${calculation.holidayDays} jour(s)`;
            }

            // NOUVEAU : Afficher la remise d√©gressive si applicable
            const discountLine = document.getElementById('discountLine');
            if (calculation.discountInfo && calculation.discountInfo.discount > 0) {
                discountLine.style.display = 'flex';
                document.getElementById('discountDescription').textContent = calculation.discountInfo.description + ' :';
                document.getElementById('discountAmount').textContent = `-${calculation.discountAmount}‚Ç¨`;
            } else {
                discountLine.style.display = 'none';
            }

            // Afficher le prix final (avec ou sans remise)
            document.getElementById('finalPrice').textContent = `${calculation.finalPrice}‚Ç¨`;

            // Ajouter un message d'encouragement si proche du palier suivant
            const encouragementMsg = getEncouragementMessage(calculation.totalDays, calculation.discountInfo);
            if (encouragementMsg) {
                showEncouragementMessage(encouragementMsg);
            }

            // G√©n√©rer le calendrier d√©taill√©
            priceCalendar.innerHTML = '<h4 style="margin: 0 0 1rem 0; color: #495057; font-size: 1rem;">üìÖ D√©tail par jour</h4>';
            
            calculation.days.forEach(day => {
                const dayElement = document.createElement('div');
                dayElement.className = `calendar-day ${day.type}`;
                dayElement.innerHTML = `
                    <span class="day-label">${formatDateFrenchShort(dateToLocalYMD(day.date))}</span>
                    <span class="day-price">${day.price}‚Ç¨</span>
                    <span class="day-modifier">${day.modifier}</span>
                `;
                priceCalendar.appendChild(dayElement);
            });

            priceDetails.style.display = 'block';
        }

        // Version courte pour le calendrier de prix
        function formatDateFrenchShort(dateString) {
            const date = new Date(dateString);
            const options = { 
                weekday: 'short', 
                month: 'short', 
                day: 'numeric'
            };
            return date.toLocaleDateString('fr-FR', options);
        }

        // Fonction pour g√©n√©rer un message d'encouragement
        function getEncouragementMessage(totalDays, currentDiscountInfo) {
            // Trouver le palier suivant
            const nextTier = progressiveDiscountTiers.find(tier => tier.minDays > totalDays);
            
            if (nextTier) {
                const daysNeeded = nextTier.minDays - totalDays;
                return `üí° Plus que ${daysNeeded} jour${daysNeeded > 1 ? 's' : ''} pour obtenir ${nextTier.description} !`;
            } else if (currentDiscountInfo && currentDiscountInfo.discount > 0) {
                return `üéâ F√©licitations ! Vous b√©n√©ficiez de la remise maximale !`;
            }
            
            return null;
        }

        // Fonction pour afficher un message d'encouragement
        function showEncouragementMessage(message) {
            // Chercher s'il y a d√©j√† un message
            let encouragementDiv = document.getElementById('encouragementMessage');
            
            if (!encouragementDiv) {
                // Cr√©er un nouveau div de message
                encouragementDiv = document.createElement('div');
                encouragementDiv.id = 'encouragementMessage';
                encouragementDiv.style.cssText = `
                    background: linear-gradient(135deg, #E7A84B 0%, #d99535 100%);
                    color: white;
                    padding: 0.8rem;
                    border-radius: 8px;
                    margin: 1rem 0;
                    text-align: center;
                    font-weight: 600;
                    box-shadow: 0 4px 15px rgba(231, 168, 75, 0.3);
                `;
                
                // Ins√©rer apr√®s le r√©sum√© de prix
                const priceDetails = document.getElementById('priceDetails');
                const priceCalendar = document.getElementById('priceCalendar');
                priceDetails.insertBefore(encouragementDiv, priceCalendar);
            }
            
            encouragementDiv.textContent = message;
            encouragementDiv.style.display = 'block';
        }



        function resetToDefaultDisplay() {
            const allCarCards = document.querySelectorAll('.car-card');
            const apologizeMessage = document.getElementById('apologizeMessage');
            const availabilityInfo = document.getElementById('availabilityInfo');
            
            console.log('üîÑ R√©initialisation de l\'affichage par d√©faut...');
            
            // Masquer le message d'excuse et les infos de disponibilit√©
            apologizeMessage.style.display = 'none';
            availabilityInfo.style.display = 'none';
            
            // Afficher toutes les voitures avec le statut d'aujourd'hui
            allCarCards.forEach(card => {
                card.style.display = 'block';
            });
            
            // V√©rifier le statut r√©el d'aujourd'hui SANS d√©clencher d'alertes
            // checkTodayAvailabilityQuiet(); // D√©sactiv√© - utilise l'ancien syst√®me localStorage
            
            console.log('‚úÖ Affichage r√©initialis√© sans alertes');
        }

        function checkTodayAvailabilityQuiet() {
            const today = todayLocal();
            let availableToday = 0;
            
            Object.keys(carsDatabase).forEach((carId, index) => {
                const isAvailable = isCarAvailable(carId, today, today);
                const cardElement = document.querySelector(`[data-car-id="${carId}"]`);
                
                if (cardElement) {
                    const statusElement = cardElement.querySelector('.car-status');
                    const buttonElement = cardElement.querySelector('.reserve-btn');
                    
                    if (isAvailable) {
                        statusElement.textContent = 'Disponible';
                        statusElement.className = 'car-status status-available';
                        buttonElement.disabled = false;
                        availableToday++;
                    } else {
                        statusElement.textContent = 'R√©serv√©';
                        statusElement.className = 'car-status status-reserved';
                        buttonElement.disabled = true;
                    }
                }
            });
            
            console.log(`üìä Statut aujourd'hui (silencieux): ${availableToday} voiture(s) disponible(s)`);
            
            // NE PAS afficher d'alerte, juste retourner le nombre
            return availableToday;
        }


    </script>

    <!-- Script d'int√©gration API dynamique (ajout√©) -->
    <script>
    // Tentative de synchronisation initiale avec l'API backend
    (async function initApiSync() {
        const API_BASE = 'http://localhost:3001';
        console.log('üîÑ Tentative de connexion √† l\'API FandiRent ...');
        try {
            const carsResp = await fetch(`${API_BASE}/cars`);
            if (!carsResp.ok) throw new Error('R√©ponse /cars non OK');
            const carsData = await carsResp.json();
            console.log('‚úÖ Voitures r√©cup√©r√©es depuis API:', carsData);

            // Mettre √† jour / enrichir carsDatabase existant
            carsData.forEach(car => {
                if (!carsDatabase[car.id]) {
                    carsDatabase[car.id] = {
                        id: car.id,
                        name: car.name,
                        price: car.price,
                        image: car.image || '',
                        reservations: []
                    };
                } else {
                    carsDatabase[car.id].name = car.name;
                    carsDatabase[car.id].price = car.price;
                    if (car.image) carsDatabase[car.id].image = car.image;
                }
            });

            // R√©cup√©rer toutes les r√©servations en un appel
            const resResp = await fetch(`${API_BASE}/reservations`);
            if (resResp.ok) {
                const reservationsData = await resResp.json();
                // R√©initialiser les tableaux de r√©servation
                Object.keys(carsDatabase).forEach(cid => carsDatabase[cid].reservations = []);
                reservationsData.forEach(r => {
                    if (carsDatabase[r.carId]) {
                        carsDatabase[r.carId].reservations.push({
                            id: r.id,
                            startDate: r.startDate,
                            endDate: r.endDate,
                            customerName: r.customerName
                        });
                    }
                });
                console.log('‚úÖ R√©servations synchronis√©es depuis API:', reservationsData.length);
            } else {
                console.warn('‚ö†Ô∏è Impossible de charger /reservations (status)', resResp.status);
            }

            // Appliquer les statuts actuels
            applyTodayReservationsStatus();
            console.log('üíæ Base locale mise √† jour depuis API.');
        } catch (err) {
            console.warn('‚ùå API non accessible, utilisation du jeu de donn√©es local. D√©tail:', err.message);
        }
    })();
    </script>

    <!-- Overlay et alerte centrale -->
    <div class="alert-overlay" id="alertOverlay"></div>
    <div class="center-alert" id="centerAlert">
        <div class="alert-icon" id="alertIcon">‚ùå</div>
        <h3 id="alertTitle">Aucune voiture disponible</h3>
        <p id="alertMessage">Aucune voiture n'est disponible pour ces dates. Essayez d'autres dates.</p>
        <button class="close-alert" onclick="closeCenterAlert()">Fermer</button>
    </div>

    <!-- Ic√¥ne WhatsApp flottante -->
    <a href="https://api.whatsapp.com/send/?phone=213771391480&text=Bonjour,%20je%20souhaite%20louer%20une%20voiture&type=phone_number&app_absent=0" 
       target="_blank" 
       class="whatsapp-float" 
       data-contact="whatsapp"
       title="Contactez-nous sur WhatsApp">
    </a>

    <!-- Script de calcul prix avec majoration weekend -->
    <script src="js/carPricing.js"></script>
    
    <!-- Script de gestion des informations de contact -->
    <script src="js/contact-info.js"></script>
    
    <!-- Script de gestion du th√®me Dark/Light -->
    <script src="js/theme.js"></script>

    <!-- Script de partage social -->
    <script>
        function shareOnFacebook() {
            const url = encodeURIComponent(window.location.href);
            const shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}`;
            window.open(shareUrl, 'facebook-share', 'width=600,height=400');
        }

        function shareOnTwitter() {
            const url = encodeURIComponent(window.location.href);
            const text = encodeURIComponent('D√©couvrez FANDIAUTO - Location de voitures en Alg√©rie üöó');
            const shareUrl = `https://twitter.com/intent/tweet?url=${url}&text=${text}`;
            window.open(shareUrl, 'twitter-share', 'width=600,height=400');
        }

        function shareOnWhatsApp() {
            const url = encodeURIComponent(window.location.href);
            const text = encodeURIComponent('D√©couvrez FANDIAUTO - Location de voitures en Alg√©rie üöó\n');
            const shareUrl = `https://wa.me/?text=${text}${url}`;
            window.open(shareUrl, '_blank');
        }

        function copyLink() {
            const url = window.location.href;
            
            // Try using the modern Clipboard API
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(url).then(() => {
                    showCopyNotification('Lien copi√© dans le presse-papier ! üìã');
                }).catch(err => {
                    fallbackCopyLink(url);
                });
            } else {
                fallbackCopyLink(url);
            }
        }

        function fallbackCopyLink(url) {
            // Fallback for older browsers
            const textArea = document.createElement('textarea');
            textArea.value = url;
            textArea.style.position = 'fixed';
            textArea.style.left = '-999999px';
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                document.execCommand('copy');
                showCopyNotification('Lien copi√© dans le presse-papier ! üìã');
            } catch (err) {
                showCopyNotification('Erreur lors de la copie. Veuillez copier manuellement: ' + url, true);
            }
            
            document.body.removeChild(textArea);
        }

        function showCopyNotification(message, isError = false) {
            // Create notification element
            const notification = document.createElement('div');
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                bottom: 100px;
                right: 30px;
                background: ${isError ? '#e74c3c' : '#27ae60'};
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                z-index: 10000;
                font-weight: 500;
                animation: slideInRight 0.3s ease-out;
            `;
            
            document.body.appendChild(notification);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.3s ease-out';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Add animation styles
        if (!document.getElementById('share-animations')) {
            const style = document.createElement('style');
            style.id = 'share-animations';
            style.textContent = `
                @keyframes slideInRight {
                    from {
                        transform: translateX(400px);
                        opacity: 0;
                    }
                    to {
                        transform: translateX(0);
                        opacity: 1;
                    }
                }
                @keyframes slideOutRight {
                    from {
                        transform: translateX(0);
                        opacity: 1;
                    }
                    to {
                        transform: translateX(400px);
                        opacity: 0;
                    }
                }
            `;
            document.head.appendChild(style);
        }
    </script>
</body>
</html>
